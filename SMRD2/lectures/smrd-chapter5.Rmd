---
title: "`r SMRD:::info('book')`"
subtitle: "`r SMRD:::info('chapter5')`"
author: "`r SMRD:::info('authors')`"
date: "`r format(Sys.Date(), '%d %B %Y')`"
footer: "`r paste('SMRD: ', SMRD:::info('chapter5'))`"
output:
  slidy_presentation:
    smart: false
    fig_caption: yes
runtime: shiny
graphics: yes
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
assign('dynamic', TRUE, envir = sys.frame(),immediate = TRUE)
source('scripts/R/setup.R')
library(DT)
```

# OVERVIEW

```{r}
shiny::includeCSS('scripts/css/flat-slidy.css')
shiny::includeScript(path = "scripts/js/audiojs/audiojs/audio.min.js",
                     "audiojs.events.ready(function() {audiojs.createAll();});")
shiny::includeScript("scripts/js/jkf-scroll.js")
```

## This chapter explains...

- More advanced parametric distributions than those described in Chapter 4

- The properties and importance of parametric distributions that cannot be transformed into a location-scale distribution

- Threshold-parameter distributions

- How some statistical distributions can be determined by applying basic ideas of probability theory to physical properties of a system or population of units

- For the distributions presented in this chapter no closed-form solution exists for the hazard rate function

# 5.2 - Gamma Distribution

## $\text{For}\; T \sim GAM(\theta,\kappa),\;\;T \in [0,\infty)$ 

<small>
$$
\begin{aligned}
f(t|\theta,\kappa)&=\frac{1}{\Gamma(\kappa)\theta}\left(\frac{t}{\theta}\right)^{\kappa-1}\\\\
F(t|\theta,\kappa)&=\Gamma_{I}\left(\frac{t}{\theta},\kappa\right)\\\\
t_{p}&=\theta\Gamma_{I}^{-1}(p,\kappa)\\\\
E[T]&=\kappa\theta\\\\
Var[T]&=\kappa\theta^2
\end{aligned}
$$
</small>

- Where $\Gamma_{I}(x,a)$ is the (lower) incomplete gamma function 

- In R, $\Gamma_{I}(x,a)\equiv$ `gsl::gamma_inc(x,a)`

## Gamma Distribution App

```{r}
if(dynamic) teachingApps:::distribution_gamma()
```

# 5.3 - Generalized Gamma Distribution

## $\text{For}\; Y \sim GENG(\theta,\beta, \kappa),\;\;Y\in(0,\infty)$ 

<small>
$$
\begin{aligned}
f(t|\theta,\beta,\kappa)&=\Gamma_{I}\left[\left(\frac{t}{\theta}\right)^{\beta},\kappa\right]\\\\
F(y|\theta,\beta,\kappa)&=\frac{\beta}{\Gamma(\kappa)\theta}\left(\frac{t}{\theta}\right)^{\kappa\beta-1}\exp\left[-\left(\frac{t}{\theta}\right)^{\beta}\right]\\\\
t_{p}&=\theta \left[\Gamma_{I}^{-1}(p;\kappa)\right]^{1/\beta}\\\\
E[Y]&=\frac{\theta\Gamma(1/\beta+\kappa}{\Gamma(\kappa)}\\\\
Var[Y]&=\theta^2\left[\frac{\Gamma(2/\beta+\kappa)}{\Gamma(\kappa)}-\frac{\Gamma^{2}(1/\beta)+\kappa}{\Gamma^{2}(\kappa)}\right]
\end{aligned}
$$
</small>

## Special cases for $T \sim GENG(\theta,\beta,\kappa)$

- When $\beta = 1, \;\;\; T \sim GAM(\theta,\kappa)$

- When $\kappa = 1, \;\;\; T \sim WEIB(\theta,\beta)$

- When $(\beta,\kappa) = (1,1), \;\;\; T \sim EXP(\theta)$

- As $\kappa \rightarrow \infty, \;\;\; T\xrightarrow{d} LOGNOR(\log(\theta)+\log(\kappa)/\beta, 1/(\beta\sqrt{\kappa}))$

## GENG Distribution App

```{r}
if(dynamic) teachingApps:::distribution_geng()
```

# 5.4 - Extendend Generalized Gamma Distribution

## $\text{For}\; T \sim EGENG(\mu,\sigma, \lambda),\;\;T\in[0,\infty)$

<small>
$$
\begin{aligned}
f(t|\mu,\sigma,\lambda)&=\begin{cases} \frac{\lambda}{\sigma t} \phi_{lg}\left[\lambda\omega+ \ln(\lambda^{-2}); \lambda^{-2}\right] &\mbox{if } \lambda \ne 0\\\\
\frac{1}{\sigma t} \phi_{nor}(\omega) &\mbox{if } \lambda = 0 \end{cases}\\\\
F(t|\mu,\sigma,\lambda)&=\begin{cases}\Phi_{lg}\left[\lambda\omega+ \ln(\lambda^{-2}); \lambda^{-2}\right] &\mbox{if } \lambda > 0\\\\
\Phi_{nor}(\omega) &\mbox{if } \lambda = 0\\\\
1-\Phi_{lg}\left[\lambda\omega+\ln(\lambda^{-2});\lambda^{-2}\right]&\mbox{if }\lambda <0\end{cases}\\\\
t_{p}&=\exp\left[\mu+\sigma\times \omega(p;\lambda)\right]\\\\
E[T]&=\exp(\mu+0.5\sigma^2)\\\\
Var[T]&=\exp(2\mu+\sigma^2)(\exp(\sigma^2)-1)
\end{aligned}
$$
</small>

## For $T\sim EGENG(\mu,\sigma,\lambda)$ the following special cases exist

- If $\lambda>0,\;\;\;\;\;\;\; T \sim GENG(\mu, \sigma,\lambda)$

- If $\lambda=1,\;\;\;\;\;\;\;T \sim WEIB(\mu,\sigma)$

- If $\lambda=0,\;\;\;\;\;\;\; T \sim LOGNOR(\mu,\sigma)$

- If $\lambda=-1,\;\;\;\; T^{-1} \sim WEIB(-\mu,\sigma), \text{ aka the Frechet distribution }$

- If $\lambda=\sigma,\;\;\;\;\;\;\; T \sim GAM(\theta,\kappa), \text{ where } \theta=\lambda^2\exp(\mu)\text{ and } \kappa=\lambda^{-2}$

- If $\lambda=\sigma=1, T \sim EXP(\theta), \text{ where } \theta=\exp(\mu)$$

## Extended Generalized Gamma Distribution App

```{r}
if(dynamic) teachingApps:::distribution_egeng()
```

# 5.6 - Inverse Gaussian Distribution

## $\text{For}\; T \sim IGAU(\theta,\beta),\;\;T\in[0,\infty)$ 

<small>
$$
\begin{aligned}
f(t|\theta,\beta)&=\frac{\sqrt{\beta}}{\exp(z/2)}\phi_{nor}\left(\sqrt{\beta}\left[\frac{\exp(z)-1}{\exp(z/2)}\right]\right)\\\\
F(t|\theta,\beta)&=\Phi_{nor}\left(\sqrt{\beta}\left[\frac{\exp(z)-1}{\exp(z/2)}\right]\right)+\exp(2\beta)\Phi_{nor}\left(-\sqrt{\beta}\left[\frac{\exp(z)+1}{\exp(z/2)}\right]\right)\\\\
t_{p}&=\theta\exp\left[\mu+\Phi^{-1}_{ligau}(p;\beta)\right]\\\\
E[T]&=\theta\\\\
Var[T]&=\theta/\beta^2
\end{aligned}
$$
</small>

## Inverse Gaussian Distribution

```{r}
if(dynamic) teachingApps:::distribution_igau()
```

# 5.7 - Birnbaum-Saunders Distribution

## $\text{For}\; T \sim BISA(\theta,\beta),\;\;T\in[0,\infty)$ 

<small>
$$
\begin{aligned}
f(t|\theta,\beta)&=\frac{\sqrt{\frac{t}{\theta}}+\sqrt{\frac{\theta}{t}}}{2\beta t} \phi_{nor}\left(z)\right)\\\\
F(t|\theta,\beta)&=\Phi_{nor}\left(z\right)\\\\
t_{p}&=\frac{\theta}{4}\left[\beta\Phi^{-1}_{nor}(p)+\sqrt{4+\left[\beta\Phi_{nor}^{-1}(p) \right]^2}\right]^2\\\\
E[T]&=\theta\left(1+\frac{\beta^2}{2}\right)\\\\
Var[T]&=(\theta\beta)^2\left(1+\frac{5\beta^2}{4}\right)
\end{aligned}
$$
</small>

## Birnbaum-Saunders Distribution App

```{r}
if(dynamic) teachingApps:::distribution_bisa()
```

# 5.8 - Gompertz-Makeham Distribution

## $\text{For}\; T \sim GOMA(\theta,\zeta, \eta),\;\;T\in[0,\infty)$ 

<small>
$$
\begin{aligned}
f(t|\theta,\zeta,\eta)&=\frac{1}{t}\phi_{lgoma}\left[\ln\left(\frac{t}{\theta}\right);\zeta,\eta\right]\\\\
F(t|\theta,\zeta,\eta)&=\Phi_{lgoma}\left[\ln\left(\frac{t}{\theta}\right);\zeta,\eta\right]\\\\
h(t|\theta,\zeta,\eta)&=\frac{\eta}{\theta}+\frac{\exp(-\zeta)}{\theta}\exp\left(\frac{t}{\theta}\right)\\\\
t_{p}&=\theta\exp\left[\Phi^{-1}_{lgoma}(p;\zeta,\eta)\right]
\end{aligned}
$$
</small>

## Gompertz-Makeham Distribution App

```{r}
if(dynamic) teachingApps:::distribution_goma()
```

# 5.10 - Distributions With a Threshold Parameter

# 5.10.1 - Background

Many of the distributions introduced up to this point are defined on $\mathcal{R}^+$

- Most log-location scale distributions 
- Some of the more complex distributions

For these distributions, $F(t)$ begins increasing at $t=0$

Each of these distributions can be generalized by adding a __threshold parameter__,$\gamma\ge0$

If $\gamma>0$ the entire distribution is shifted by a value equal to $\gamma$ 

- Denotes that failures <u>__cannot__</u> occur $\forall t< \gamma$ 
- This can be useful for fitting distribution that are highly right-skewed

## Figure 5.6

```{r}
if(dynamic) teachingApps:::figure5_6()
```

# 5.11.2 Generalized Threshold-Scale cdf & pdf 

The form of the cdf for the generalized threshold-scale (GETS) distribution is

$$F(t,\alpha, \sigma,\xi)=\begin{cases}\Phi\left[\log(1+\sigma z)^{1/\sigma}\right] &\mbox{for } \sigma>0, z>-1/\sigma\\\\ \Phi(z) &\mbox{for } \sigma=0,z\in(\infty,\infty)\\\\ 1-\Phi\left[\log(1+\sigma z)^{1/|\sigma|}\right] &\mbox{for } \sigma<0, z<-1/\sigma\end{cases}$$

- where 

$$
\begin{aligned}
\Phi &\equiv \text{ Form of generic cdf with standard parameter values}\\\\
z&=\frac{t-\alpha}{\xi}\\
\sigma &\in(-\infty,\infty)\\\\
\alpha &\in (-\infty,\infty)\\\\
\xi&>0
\end{aligned}
$$

# 5.11.2 Generalized Threshold-Scale cdf & pdf 

The form of the pdf for the generalized threshold-scale (GETS) distribution is

$$f(t,\alpha, \sigma,\xi)=\begin{cases}\phi\left[\log(1+\sigma z)^{1/|\sigma|}\right]\times \frac{1}{\xi(1+\sigma z)} &\mbox{for } \sigma\ne 0\\\\ \phi(z) \times \frac{1}{\xi} &\mbox{for } \sigma=0\\ \end{cases}$$

Finally, inverting the GETS cdf gives the quantile function

$$t_{p}=\alpha +\xi\times w(\sigma,p)$$

- where

$$w(\sigma,p)=\begin{cases}\frac{\exp\left[\sigma\Phi^{-1}(p)\right]-1}{\sigma} &\mbox{for } \sigma>0\\\\ \Phi^{-1}(p) &\mbox{for } \sigma=0\\\\ \frac{\exp\left[|\sigma|\Phi^{-1}(1-p)\right]-1}{\sigma} &\mbox{for } \sigma<0\end{cases}$$

# 5.11.4 Special Cases of the GETS Distribution

- Recall from Chapter 4, the location-scale form of the normal, SEV, and LEV distributions  

$$
\begin{aligned}
F(t|\alpha,0,\xi)&=\Phi_{nor}\left[\frac{t-\alpha}{\xi}\right]\\\\
F(t|\alpha,0,\xi)&=\Phi_{sev}\left[\frac{t-\alpha}{\xi}\right]\\\\
F(t|\alpha,0,\xi)&=\Phi_{lev}\left[\frac{t-\alpha}{\xi}\right]
\end{aligned}
$$

- The threshold log-location-scale form of the NOR-GETS, SEV-GETS, and LEV-GETS distributions are 

$$
\begin{aligned}
F(t|\alpha,0,\xi)&=\Phi_{nor}\left[\frac{\log(t-\gamma)-\alpha}{\xi}\right]\\\\
F(t|\alpha,0,\xi)&=\Phi_{sev}\left[\frac{\log(t-\gamma)-\alpha}{\xi}\right]\\\\
F(t|\alpha,0,\xi)&=\Phi_{lev}\left[\frac{\log(t-\gamma)-\alpha}{\xi}\right]
\end{aligned}
$$

Where $\gamma=\alpha-\xi/\sigma \text{ and } \mu=\log(\xi/\sigma)$

## 5.11.4 NOR-GETS Distribution

```{r}
if(dynamic) teachingApps:::distribution_norgets()
```

## 5.11.4 SEV-GETS Distribution

```{r}
if(dynamic) teachingApps:::distribution_sevgets()
```

## LEV-GETS Distribution

```{r}
if(dynamic) teachingApps:::distribution_levgets()
```

# 5.12 - Other Methods of Deriving Failure-Time Distributions

## Background

The basic idea behind these methods is to model the physical/chemical process that cause failure

___Mixture distributions___

- Arise if a data set contains observations from two or more distinct processes
- Mixtures can be finite or continuous

___Power Distributions___

- Distributions of minima and maxima of $iid$ random variables have important applications
- Are related to reliability block diagrams (series/parallel components)

___Physical/Chemical Degradation Distributions___ Chapters 13 & 18

## Mixture Distributions

Mixture distributions result 

- If a population of products are manufactured using differnt processes

- If a population of products are manufactures using different raw materials

- If a population of products operates in distinctly different environments

## Finite Mixture Distributions

<font color="red">__Suppose we are interested in testing the fracture toughness of a new glass material to be used in future touchscreens__</font>

- <u>__Fracture toughness:__</u> total energy that a material can absorb before fracture

- Greater toughness implies that if a phone is dropped the screen could flex and absorb the impact energy without cracking

- <u>__Test:__</u> apply specified load to material samples every second until fracture occurs

- <u>__Response of interest:__</u> number of load cycles at fracture $N$

- Distribution failure cycles will be compared to legacy materials 

<font color="red">__Further suppose that__</font>

- 60% of the specimens were manufactured using materials from Supplier A 
- The other 40% were manufactured using materials from Supplier B
- The Supplier B specimens contain contaminants, thus $(E[N_{A}] \ne E[N_{B}])$

The failure time distribution of entire sample could be expressed as

$$F(N|\mu,\sigma)=0.4\times F(N|\mu_{A},\sigma) + 0.6\times F(N|\mu_{B},\sigma)$$

- If the failure time distributions of both samples have the same form (come from the same distribution family) 
- $\mu_{A},\mu_{B},\;\text{and}\;\sigma$ are estimated separately

## Continuous Mixture Distributions 

It's unlikely that the level of contaminant in the specimens will only have two levels

- We'd expect the level of contaminant to fall on a continuous spectrum
- We'd also expect the level of contaminant across the population of specimens to follow some distribution

This more general case results in a continuous mixture distribution, where

$$
\begin{aligned}
F(N|\mu,\sigma,\mathbf{\theta})=P(N\le n)&=\int_{-\infty}^{\infty}P(N\le n|\mu=\mu_{1},\sigma)f_{\mu_{1}}(\mu_1|\mathbf{\theta})d\mu_{1}\\\\
&=\int_{-\infty}^{\infty}F_{N|\mu=\mu_{1}}(n|\mathbf{\mu},\sigma,\mathbf{\theta})f_{\mu_{1}}(\mu_1|\mathbf{\theta})d\mu_{1}
\end{aligned}
$$

and

$$f(N|\mu,\sigma,\mathbf{\theta})=\int_{-\infty}^{\infty}f_{N|\mu=\mu_{1}}(n|\mathbf{\mu},\sigma,\mathbf{\theta})f_{\mu_{1}}(\mu_1|\mathbf{\theta})d\mu_{1}$$

## Minimum-Type Distributions


For components in series, the system fails when ANY component fails

<center>
![](images/mermaid-series.gif)
</center>

the system cdf $F_{system}(t)$ can be expressed as

<font size="4.75">
$$P(T_{system}\le t)=1-P(T_{A}>t)\cap P(T_{B}>t)\cap P(T_{C}>t)\cap P(T_{D}>t)\cap P(T_{E}>t)$$
</font>

<font color="red">__BUT__</font>, if we can reasonably assume independence among the components...i.e.

<font size="4.75">
$$P(T_{A}>t)\perp P(T_{B}>t)\perp P(T_{C}>t)\perp P(T_{D}>t)\perp P(T_{E}>t)$$ 
</font>

then $F_{system}(t)$ becomes

<smaller>
$$P(T_{system}\le t)=1-P(T_{A}>t)\times P(T_{B}>t)\times P(T_{C}>t)\times P(T_{D}>t)\times P(T_{E}>t)$$
</smaller>

Example: $T_{A,B,C,D,E} \sim i.i.d EXP(\theta = 2)$ 

<small>
$$
\begin{aligned}
F_{system}(T)&=1-\exp\left[-0.5t\right]\exp\left[-0.5t\right]\exp\left[-0.5t\right]\exp\left[-0.5t\right]\exp\left[-0.5t\right]\\\\
&=1-\exp\left[-(0.5+0.5+0.5+0.5+0.5)t\right]\\\\
&=1-\exp\left[-2.5t\right]
\end{aligned}
$$
</small>

Therefore, we see that for a system with 

- $n = 1,2,...$ components - arranged in series
- Where the lifetime of each component $T_{i}\sim EXP(\theta_{i}), \;\;i= 1,2,...n$

The system lifetime $T_{system}\sim EXP\left(\sum_{i=1}^n\theta_{i}\right)$ 

## For items in series, $S(t_{i})\le\min S_{i}(t_{i})$

```{r series, echo=FALSE, fig.align='center', fig.height=5}
par(family = "serif", bg = NA)
curve(pexp(x,0.5), yaxt = "n", xlab = "Time", ylab = "F(t)", lwd = 2, ylim = c(0,1))
curve(pexp(x,1.0), col = 2, lwd = 2, add = TRUE)
curve(pexp(x,1.5), col = 3, lwd = 2, add = TRUE)
curve(pexp(x,2.0), col = 4, lwd = 2, add = TRUE)
curve(pexp(x,2.5), col = 5, lwd = 2, add = TRUE)
axis(side = 2, las = 1)
box(lwd = 1.5)
legend("topleft", c(expression(theta==0.5),expression(theta==1.0),
                    expression(theta==1.5),expression(theta==2.0), 
                    expression(theta==2.5)), 
       lwd = 2, col = 1:5, bty = "n")
```

```{r series, eval=FALSE, echo=TRUE}
```

## Maximum-Type Distributions

For components in parallel, the system fails when ALL of the components fail

<center>
![](images/mermaid-parallel.gif)
</center>


The system cdf $F_{system}(t)$ for components in parallel can be expressed as

$$P(T_{system}\le t)=P(T_{B}\le t)\cap P(T_{C}\le t)\cap P(T_{D}\le t)$$

<font color="red">__AGAIN__</font>, if we can assume independence among the components...i.e.

<font size="5">
$$P(T_{B}\le t)\perp P(T_{C}\le t)\perp P(T_{D}\le t)$$ 
</font>

then $F_{system}(t)$ becomes

<font size="5.5">
$$
\begin{aligned}
P(T_{system}\le t)&=P(T_{B}\le t)\times P(T_{C}\le t)\times P(T_{D}\le t)\\\\
&=\prod_{i=1}^n P(T_{i}\le t)
\end{aligned}
$$
</font>

Example: $T_{B,C,D} \sim i.i.d EXP(\theta = 2)$ 

<font size="5">
$$
\begin{aligned}
F_{system}(T)&=(1-\exp\left[-0.5t\right])(1-\exp [-0.5t])(1-\exp \left[-0.5t\right])\\\\
&=1 - 2\exp [-0.5t]+ \exp [-t] (1-\exp [-0.5t])\\\\
&=1-3\exp\left[-0.5t\right]+3\exp [-t]-\exp [-1.5t]
\end{aligned}
$$
</font>

Therefore, we see that for a system with 

- $n = 1,2,...$ components arranged in parallel
- Where the lifetime of each component $T_{i}\sim EXP(\theta_{i}), \;\;i= 1,2,...n$

The system lifetime $T_{system}$ is not exponential 

## For items in parallel, $S(t_{i})\ge\max S_{i}(t_{i})$


```{r parallel, echo=FALSE, fig.align='center', fig.height=5}
par(family = "serif", las = 1)
curve(pexp(x,0.5), yaxt = "n", xlab = "Time", ylab = "F(t)", lwd = 2, ylim = c(0,1))
curve(1-2*(1-pexp(x,0.5))+(1-pexp(x,1.0)), col = 2, lwd = 2, add = TRUE)
curve(pexp(x,0.5)*(1-2*(1-pexp(x,0.5))+(1-pexp(x,1.0))), col = 3, lwd = 2, add = TRUE)
axis(side = 2, las = 1)
box(lwd = 1.5)
legend("topleft", c(expression("[F(t)]"**1),
                    expression("[F(t)]"**2),
                    expression("[F(t)]"**3)), 
       lwd = 2, col = 1:5, bty = "n")
```

```{r parallel, eval=FALSE, echo=TRUE}
```
