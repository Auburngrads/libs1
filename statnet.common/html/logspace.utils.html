<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Utilities for performing calculations on logarithmic scale.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for logspace.utils {statnet.common}"><tr><td>logspace.utils {statnet.common}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Utilities for performing calculations on logarithmic scale.</h2>

<h3>Description</h3>

<p>A small suite of functions to compute sums, means, and weighted means on
logarithmic scale, minimizing loss of precision.
</p>


<h3>Usage</h3>

<pre>
log_sum_exp(logx, use_ldouble = FALSE)

log_mean_exp(logx, use_ldouble = FALSE)

lweighted.mean(x, logw)

lweighted.var(x, logw)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>logx</code></td>
<td>
<p>Numeric vector of <i>\log(x)</i>, the natural logarithms of the
values to be summed or averaged.</p>
</td></tr>
<tr valign="top"><td><code>use_ldouble</code></td>
<td>
<p>Whether to use <code>long double</code> precision in the
calculation. If <code>TRUE</code>, 's C built-in <code>logspace_sum()</code> is used. If
<code>FALSE</code>, the package's own implementation based on it is used, using
<code>double</code> precision, which is (on most systems) several times faster, at
the cost of precision.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>Numeric vector of <i>x</i>, the (raw) values to be summed or
averaged. For <code>lweighted.mean</code>, <code>x</code> may also be a matrix, in which
case the weighted mean will be computed for each column of <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>logw</code></td>
<td>
<p>Numeric vector of <i>\log(w)</i>, the natural logarithms of the
weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions return the equivalents of the following R expressions,
but faster and with less loss of precision: </p>

<dl>
<dt><code>log_sum_exp(logx)</code></dt><dd><p><code>log(sum(exp(logx)))</code></p>
</dd>
<dt><code>log_mean_exp(logx)</code></dt><dd><p><code>log(mean(exp(logx)))</code></p>
</dd>
<dt><code>lweighted.mean(x,logw)</code></dt><dd><p><code>sum(x*exp(logw))/sum(exp(logw))</code> for <code>x</code> scalar and
<code>colSums(x*exp(logw))/sum(exp(logw))</code> for <code>x</code> matrix</p>
</dd>
<dt><code>lweighted.var(x,logw)</code></dt><dd><p><code>crossprod(x*exp(logw/2))/sum(exp(logw))</code></p>
</dd> </dl>



<h3>Author(s)</h3>

<p>Pavel N. Krivitsky
</p>


<h3>Examples</h3>

<pre>

logx &lt;- rnorm(1000)
stopifnot(all.equal(log(sum(exp(logx))), log_sum_exp(logx)))
stopifnot(all.equal(log(mean(exp(logx))), log_mean_exp(logx)))

x &lt;- rnorm(1000)
logw &lt;- rnorm(1000)
stopifnot(all.equal(m &lt;- sum(x*exp(logw))/sum(exp(logw)),lweighted.mean(x, logw)))
stopifnot(all.equal(sum((x-m)^2*exp(logw))/sum(exp(logw)),
                    lweighted.var(x, logw), check.attributes=FALSE))

x &lt;- cbind(x, rnorm(1000))
stopifnot(all.equal(m &lt;- colSums(x*exp(logw))/sum(exp(logw)),
                    lweighted.mean(x, logw), check.attributes=FALSE))
stopifnot(all.equal(crossprod(t(t(x)-m)*exp(logw/2))/sum(exp(logw)),
                    lweighted.var(x, logw), check.attributes=FALSE))
</pre>

<hr /><div style="text-align: center;">[Package <em>statnet.common</em> version 4.1.2 <a href="00Index.html">Index</a>]</div>
</body></html>
