<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Circulant Embedding methods</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Circulant Embedding {RandomFields}"><tr><td>Circulant Embedding {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Circulant Embedding methods</h2>

<h3>Description</h3>

<p>Circulant embedding is a fast simulation method for stationary
(possibly anisotropic) Gaussian random
fields on regular grids based on Fourier transformations. It is guaranteed to be an exact method
for covariance functions with finite support, e.g. the spherical
model. The method is admissible for any dimension apart from memory
restrictions. <br />
The simulation is performed on a torus which represents the bended
grid. To remove wrong dependencies occuring at different borders of the
grid which would be close on the torus, the simulation area is
multiplied by a natural number.
There is also a multivariate version of circulant embedding.
</p>
<p>Cut-off embedding is a fast simulation method for stationary,
isotropic Gaussian random fields on square lattices based on
the standard <code><a href="RPcirculant.html">RPcirculant</a></code> method,
so that exact simulation is garantueed
for further covariance models, e.g. the <code><a href="RMmatern.html">RMwhittle</a></code> model.
</p>
<p>In fact, the circulant embedding is called with the cutoff
hypermodel, see <code><a href="RMcutoff.html">RMcutoff</a></code>.
<code>Cutoff</code> halfens the maximum number of
elements models used to define the covariance function of interest
(from 10 to 5).
</p>
<p>Here, multiplicative models are not allowed (yet).
<br />
For details see <code><a href="RMcutoff.html">RMcutoff</a></code>.
</p>
<p>Intrinsic embedding is a fast simulation method for intrinsically stationary,
isotropic Gaussian random fields on square lattices based on
the standard <code><a href="RPcirculant.html">RPcirculant</a></code> method,
for further <em>variogram</em> models, e.g. <code><a href="RMfbm.html">RMfbm</a></code>.
</p>
<p>Note that the simulated random field is always <em>non-stationary</em>.
In fact, the circulant embedding is called with the Intrinsic
hypermodel, see <code><a href="RMintrinsic.html">RMintrinsic</a></code>.
</p>
<p>Here, multiplicative models are not allowed (yet).
<br />
For details see <code><a href="RMintrinsic.html">RMintrinsic</a></code>.
</p>


<h3>Usage</h3>

<pre>
RPcirculant(phi, boxcox, force, mmin, strategy,
 maxGB, maxmem,  tolIm, tolRe, trials, useprimes, dependent,
 approx_step, approx_maxgrid)

RPcutoff(phi, boxcox, force, mmin, strategy,
 maxGB, maxmem, tolIm, tolRe, trials, useprimes, dependent,
 approx_step, approx_maxgrid, diameter, a) 
 

RPintrinsic(phi, boxcox, force, mmin, strategy,
 maxGB, maxmem, tolIm, tolRe, trials, useprimes, dependent,
 approx_step, approx_maxgrid, diameter, rawR) 
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>phi</code></td>
<td>
<p>See <code><a href="RPgauss.html">RPgauss</a></code>.</p>
</td></tr>
</table>

<table summary="R argblock">
<tr valign="top"><td><code>boxcox</code></td>
<td>
<p>the one or two parameters of the box cox transformation.
If not given, the globally defined parameters are used.
See <code><a href="RFboxcox.html">RFboxcox</a></code> for details.
</p>
</td></tr>
<tr valign="top"><td><code>force</code></td>
<td>

<p>Logical. Circulant embedding does not work
if the constructed circulant
matrix has negative eigenvalues. Sometimes it is convenient
to replace all the negative eigenvalues by zero
(<code>force=TRUE</code>) after <code>trials</code> number of trials. 
Default: <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>mmin</code></td>
<td>
<p>Scalar or vector, integer if positive.
<code>CE.mmin</code> determines the initial size of the circulant
matrix. If <code>CE.mmin=0</code> the minimal starting size is
determined automatically according to the
dimensions of the grid.
If <code>CE.mmin&gt;0</code> then the absolute starting size is given.
If <code>CE.mmin&lt;0</code> then the automatically determined
matrix size is multiplied
by <i>|\code{CE.mmin}|</i>; here, <code>CE.mmin</code> must be smaller
than -1; the 
value -1 takes over the minimal starting size.<br />
Note: in any cases, the initial size might be increased according
to <code>CE.useprimes</code>.<br />
Default: <code>0</code>.
</p>
</td></tr> 
<tr valign="top"><td><code>strategy</code></td>
<td>
<p>Logical. <code>0</code>: If the circulant
matrix has negative eigenvalues then the
size in each direction is doubled; <br /> <code>1</code>: The size is
enhanced only in 
one direction, namely that one where the covariance function has the
largest value at the end point of the grid &mdash; note that
the default value of <code>trials</code> is probably too small
in that case.
</p>
<p>In some cases <code>strategy=0</code> works better, in other cases
<code>strategy=1</code>. Just try. Clearly, if the field is
isotropic and a square grid should be simulated, then
<code>strategy=0</code> is the better choice.
</p>
<p>Default: <code>0</code>.
</p>
</td></tr>
<tr valign="top"><td><code>maxGB</code></td>
<td>
<p>Maximal memory used for the circulant matrix in units of
GB.
If this argument is set then <code>maxmem</code> is set to MAXINT.
</p>
<p>Default: 1.   
</p>
</td></tr>
<tr valign="top"><td><code>maxmem</code></td>
<td>
<p>Integer.
maximal number of entries in a row of the circulant matrix. 
The total amount of memory needed for the internal calculations
is 


32 (= 4 * sizeof(double)) time as large (factor 2 is needed as complex numbers
must be considered for calculating the fft of the covariance matrix;
another factor 2 is needed for storing the simulated result).

</p>
<p>The value of <code>maxmem</code> must be at least <i>2^d</i> times as large as
the number of points to be simulated. Here, <i>d</i> is the
space dimension. In some cases even much larger.
</p>
<p>Note that <code>maxmem</code> can be used to control the automatic
choice of the simulation algorithm. Namely, in case of huge
circulant matrices, other simulation
methods (TBM) might be faster and might be preferred by the user.
</p>
<p>If this argument is set then <code>maxGB</code> is set to <code>Inf</code>.
</p>
<p>Default: <code>MAXINT</code>.
</p>
</td></tr>
<tr valign="top"><td><code>tolIm</code></td>
<td>

<p>If the modulus of the imaginary part is less than
<code>tolIm</code> then the eigenvalue is always considered as
real (independently of the value of <code>force</code>).
</p>
<p>Default: <code>1E-3</code>.
</p>
</td></tr>
<tr valign="top"><td><code>tolRe</code></td>
<td>

<p>Eigenvalues between <code>tolRe</code> and 0 are always considered as
0 and set 0 (independently of the value of <code>force</code>).
</p>
<p>Default: <code>-1E-7</code>.
</p>
</td></tr>
<tr valign="top"><td><code>trials</code></td>
<td>
<p>Integer.
A larger circulant matrix is likely to make more eigenvalues
non-negative. If at least one of the thresholds <code>tolRe</code> and
<code>tolIm</code> are missed then the matrix size is doubled
according to <code>strategy</code>,
and the matrix is checked again. This procedure is repeated
up to <code>trials - 1</code> times. If there are still negative
eigenvalues, the simulation method fails if <code>force=FALSE</code>. 
</p>
<p>Default: <code>3</code>.
</p>
</td></tr>
<tr valign="top"><td><code>useprimes</code></td>
<td>
<p>Logical. If <code>FALSE</code>
the columns of the circulant matrix
have length <i>2^k</i> for some <i>k</i>. Otherwise the algorithm
tries to find a nicely factorizable number close to the size of the
given matrix.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>dependent</code></td>
<td>
<p>Logical. If <code>FALSE</code>
then independent random fields are created. If <code>TRUE</code>
then at least 4 non-overlapping rectangles are taken out of the
the expanded grid defined by the circulant matrix.
These simulations are dependent.
See <a href="RFoptionsAdvanced.html">RFoptionsAdvanced</a> for an example.
See <code>trials</code> for some
more information on the circulant matrix.
</p>
<p>Default: <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>approx_step</code></td>
<td>
<p>Real value.
It gives the grid size of the approximating grid in case
circulant embedding is used although the points do not lie on a grid.
</p>
<p>If <code>NA</code> then <code>approx_step</code> is chosen such that
<code>approx_maxgrid</code> is nearly reached.
</p>
<p>Default: <code>NA</code>.
</p>
</td></tr>
<tr valign="top"><td><code>approx_maxgrid</code></td>
<td>

<p>It defaults to <code>maxmem</code>.
</p>
</td></tr>
<tr valign="top"><td><code>diameter</code></td>
<td>
<p>See <code><a href="RMcutoff.html">RMcutoff</a></code> or <code><a href="RMintrinsic.html">RMintrinsic</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>a</code></td>
<td>
<p>See <code><a href="RMcutoff.html">RMcutoff</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>rawR</code></td>
<td>
<p>See <code><a href="RMintrinsic.html">RMintrinsic</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, the algorithms by Dietrich and Newsam are implemented.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="RMmodel-class.html">RMmodel</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>References</h3>

<p>Circulant Embedding
</p>

<ul>
<li><p> Chan, G. and Wood, A.T.A. (1997)
An Algorithm for Simulating Stationary Gaussian Random Fields.
<em>Journal of the Royal Statistical Society: Series C (Applied
Statistics)</em>, <b>46</b>, 171&ndash;181.
</p>
</li>
<li><p> Dietrich, C. R. and G. N. Newsam (1993)
A fast and exact method for multidimensional gaussian
stochastic simulations.
<em>Water Resour. Res.</em> <b>29(8)</b>, 2861&ndash;2869.
</p>
</li>
<li><p> Dietrich, C. R. and G. N. Newsam (1996)
A fast and exact method for multidimensional Gaussian stochastic
simulations: Extension to realizations conditioned on direct and
indirect measurements 
<em>Water Resour. Res.</em> <b>32(6)</b>, 1643&ndash;1652.
</p>
</li>
<li><p> Dietrich, C. R. and Newsam, G. N. (1997)
Fast and Exact Simulation of Stationary Gaussian Processes through
Circulant Embedding of the Covariance Matrix.
<em>SIAM J. Sci. Comput.</em> <b>18</b>, 1088&ndash;1107.
</p>
</li>
<li><p> Wood, A. T. A. and Chan, G. (1994)
Simulation of Stationary Gaussian Processes in <i>[0, 1]^d</i>.
<em>Journal of Computational and Graphical Statistics</em>
<b>3</b>, 409&ndash;432. 
</p>
</li></ul>

<p>Cutoff and Intrinsic
</p>

<ul>
<li><p> Gneiting, T., Sevecikova, H, Percival, D.B., Schlather M.,
Jiang Y. (2006) Fast and Exact Simulation of Large Gaussian
Lattice Systems in $R^2$: Exploring the Limits.
<em>J. Comput. Graph. Stat.</em> <b>15</b>, 483&ndash;501.
</p>
</li>
<li><p> Stein, M.L. (2002) Fast and exact simulation of fractional
Brownian surfaces. <em>J. Comput. Graph. Statist.</em> <b>11</b>, 587&ndash;599 
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="GaussianFields.html">Gaussian</a>, <a href="RP.html">RP</a>
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

model &lt;- RMstable(s=1, alpha=1.8)
x &lt;- seq(-3,3,0.1)

z &lt;- RFsimulate(model=RPcirculant(model), x=x, y=x, n=1)
plot(z)

model &lt;- RMexp(var=10, s=2)
z &lt;- RFsimulate(model=RPcirculant(model), 1:10)
plot(z)

model &lt;- RMfbm(Aniso=diag(c(1,2)), alpha=1.5)
z &lt;- RFsimulate(model, x=1:10, y=1:10)
plot(z)

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
