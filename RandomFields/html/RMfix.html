<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fixed Covariance Matrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RMfixcov {RandomFields}"><tr><td>RMfixcov {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fixed Covariance Matrix</h2>

<h3>Description</h3>

<p><code><a href="RMfix.html">RMfixcov</a></code> is a user-defined covariance according to
the given covariance matrix.
</p>
<p>It extends to the space through a Voronoi tessellation.
</p>


<h3>Usage</h3>

<pre>
RMfixcov(M, x, y=NULL, z=NULL, T=NULL, grid, var, proj, raw, norm)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>M</code></td>
<td>
<p>a numerical matrix defining the user-defined covariance for a
random field; the matrix should be positive definite, symmetric and
its dimension should be equal to the length of observation or
simulation vector.</p>
</td></tr>
<tr valign="top"><td><code>x,y,z,T,grid</code></td>
<td>
<p>optional.
The usual arguments as in <code><a href="RFsimulate.html">RFsimulate</a></code> to define the
locations where the covariates are given.
</p>
</td></tr>
<tr valign="top"><td><code>var,proj</code></td>
<td>
<p>optional arguments; same meaning for any
<code><a href="RMmodel.html">RMmodel</a></code>. If not passed, the above
covariance function remains unmodified.</p>
</td></tr>
<tr valign="top"><td><code>raw</code></td>
<td>
<p> logical. If <code>FALSE</code> then the data are interpolated. This approach is always save, but might be slow. If <code>TRUE</code> then the data may be accessed when covariance  matrices are calculated. No rescaling or anisotropy definition  is allowed in combination with the model. The use is dangerous, but fast.<br />  Default: <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>norm</code></td>
<td>
<p>optional model that gives the norm between locations</p>
</td></tr>
</table>



<h3>Details</h3>

<p>The covariances passed are implemented for the given locations.
Within any Voronoi cell (around a given location) the correlation is
assumed to be one.
</p>
<p>In particular, it is used in <code><a href="RFfit.html">RFfit</a></code> to define neighbour or network structure in the data.
</p>


<h3>Value</h3>

<p><code><a href="RMfix.html">RMfixcov</a></code> returns an object of class <code><a href="RMmodel-class.html">RMmodel</a></code>.
</p>


<h3>Note</h3>

<p>Starting with version 3.0.64, the former argument <code>element</code>
is replaced by the <code>general</code> option <code>set</code> in
<code><a href="RFoptions.html">RFoptions</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>References</h3>


<ul>
<li><p> Ober, U., Ayroles, J.F., Stone, E.A., Richards, S., Zhu, D., Gibbs, R.A., Stricker, C., Gianola, D., Schlather, M., Mackay, T.F.C., Simianer, H. (2012): <em>Using Whole Genome Sequence Data to Predict Quantitative Trait Phenotypes in Drosophila melanogaster</em>. PLoS Genet 8(5): e1002685.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="RMcovariate.html">RMcovariate</a></code>,
<code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<code><a href="RFfit.html">RFfit</a></code>,
<code><a href="RMuser.html">RMuser</a></code>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again


## Example 1 showing that the covariance structure is correctly implemented
n &lt;- 10
C &lt;- matrix(runif(n^2), nc=n)
(C &lt;- C %*% t(C))
RFcovmatrix(RMfixcov(C), 1:n)


## Example 2 showing that the covariance structure is interpolated
RFcovmatrix(RMfixcov(C, 1:n), c(2, 2.1, 2.5, 3))


## Example 3 showing the use in a separable space-time model
model &lt;- RMfixcov(C, 1:n, proj="space") * RMexp(s=40, proj="time")
(z &lt;- RFsimulate(model, x = seq(0,12, 0.5), T=1:100))
plot(z)

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
