<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Non-stationary covariance model corresponding to a variogram...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RMcov {RandomFields}"><tr><td>RMcov {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Non-stationary covariance model corresponding to a variogram model</h2>

<h3>Description</h3>

<p>This function generalizes the well-known non-stationary covariance
function <i>2\min\{x,y\}</i> of the Brownian motion with variogram
<i>&gamma;(x,y) = |x-y|</i>, <i>x,y&ge; 0</i>
to arbitrary variogram models any spatial processes of any dimension
and multivariability.
</p>
<p>Furthermore, the
standard condition for the Brownian motion <i>W</i> is that 
variance equals <i>0</i> at the origin,
i.e., <i>W(x) =^d Z(x) -Z(0)</i> for any zero mean Gaussian process
<i>Z</i> with variogram <i>&gamma;(x,y) = |x-y|</i> is replaced by
<i>W(x) = Z(x) -&sum;_{i=1}^n a_i Z(x_i)</i> with <i>&sum;_{i=1}^n a_i
    = 1</i>.
</p>
<p>For a given variogram <i>&gamma;</i>, <i>a_i</i> and <i>x_i</i>, the model
equals
<i>C(x, y) = &sum;_{i=1}^n a_i (&gamma;(x, x_i) + &gamma;(x_i, y)) -
    &gamma;(x, y) - &sum;_{i=1}^n &sum;_{j=1}^n a_i a_j &gamma;(x_i, y_i)
  </i>
</p>


<h3>Usage</h3>

<pre>
RMcov(gamma, x, y=NULL, z=NULL, T=NULL, grid, a,
       var, scale, Aniso, proj, raw, norm)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>gamma</code></td>
<td>
<p>a variogram model. Possibly multivariate.</p>
</td></tr>
<tr valign="top"><td><code>x,y,z,T,grid</code></td>
<td>

<p>The usual arguments as in <code><a href="RFsimulate.html">RFsimulate</a></code> to define the
locations where the covariates are given.
Additional <code>x</code> might be set to one of the values
<code>"origin"</code>, <code>"center"</code>, <code>"extremals"</code>, or <code>"all"</code>.
If <code>x</code> is not given, <code>x</code> is set to <code>"origin"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>a</code></td>
<td>
<p>vector of weights. The length of <code>a</code> must equal the
number of points given by <code>x</code>, <code>y</code>, <code>z</code> and <code>T</code>.
The values of <code>a</code> must sum up to <i>1</i>.
If <code>a</code> is not given, equals weights are used.
</p>
</td></tr>
<tr valign="top"><td><code>var,scale,Aniso,proj</code></td>
<td>
<p>optional arguments; same meaning for any
<code><a href="RMmodel.html">RMmodel</a></code>. If not passed, the above covariance function
remains unmodified.</p>
</td></tr> 
<tr valign="top"><td><code>raw</code></td>
<td>
<p> logical. If <code>FALSE</code> then the data are interpolated. This approach is always save, but might be slow. If <code>TRUE</code> then the data may be accessed when covariance  matrices are calculated. No rescaling or anisotropy definition  is allowed in combination with the model. The use is dangerous, but fast.<br />  Default: <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>norm</code></td>
<td>
<p>optional model that gives the norm between locations</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="RMcov.html">RMcov</a></code> returns an object of class <code><a href="RMmodel-class.html">RMmodel</a></code>
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<code><a href="RFfit.html">RFfit</a></code>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again
bm &lt;- RMfbm(alpha=1)
plot(bm)

x &lt;- seq(0, 6, if (interactive()) 0.125 else 3)
plot(RFsimulate(bm, x))

## standardizing with the random variable at the origin
z1 &lt;- RFsimulate(RMcov(bm), x)
plot(z1)
z1 &lt;- as.vector(z1)
zero &lt;- which(abs(x) == 0)
stopifnot(abs(z1[zero]) &lt; 1e-13)

## standardizing with the random variable at the center of the interval
z2 &lt;- RFsimulate(RMcov(bm, "center"), x)
plot(z2)
z2 &lt;- as.vector(z2)
stopifnot(abs(z2[(length(z2) + 1) / 2]) &lt; 1e-13)


## standardizing with the random variables at the end points of the interval
z3 &lt;- RFsimulate(RMcov(bm, "extremals"), x)
plot(z3)
z3 &lt;- as.vector(z3)
stopifnot(abs(z3[1] + z3[length(z3)]) &lt; 1e-13)


</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
