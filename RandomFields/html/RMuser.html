<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: User-Defined Function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RMuser {RandomFields}"><tr><td>RMuser {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>User-Defined Function</h2>

<h3>Description</h3>

<p><code>RMuser</code> allows for a user-defined covariance function, variogram
model, or arbitrary function.
</p>
<p><b>RMuser is very slow &ndash; users should avoid this model whenever possible.</b>
</p>


<h3>Usage</h3>

<pre>
RMuser(type, domain, isotropy, vdim, beta,
       coordnames = c("x", "y", "z", "T"), fctn, fst, snd, envir,  
       var, scale, Aniso, proj)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>type</code></td>
<td>
<p> See <code><a href="RMmodelgenerator-class.html">RMmodelgenerator</a></code> for
the range of values of the arguments.
</p>
<p>Default: <code>"shape function"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>domain</code></td>
<td>
<p> See <code><a href="RMmodelgenerator-class.html">RMmodelgenerator</a></code> for
the range of values of the arguments.
</p>
<p>Default:  <code>XONLY</code>.
</p>
</td></tr>
<tr valign="top"><td><code>isotropy</code></td>
<td>
<p>See
<code><a href="RMmodelgenerator-class.html">RMmodelgenerator</a></code> for 
the range of values of the arguments.
</p>
<p>Default:
</p>

<ul>
<li>  <p><code>'isotropic'</code> if <code>type</code>
equals <code>'tail correlation function'</code>, <code>'positive definite'</code>
or <code>'negative definite'</code>;
</p>
</li>
<li>
<p><code>'cartesian system'</code> if
<code>type</code> indicates a process or simulation method or a shape
function. 
</p>
</li></ul>

</td></tr>
<tr valign="top"><td><code>vdim</code></td>
<td>
<p>multivariability.
</p>
<p>Default:  <code>vdim</code> is identified from <code>beta</code> if given;
otherwise the default value is <code>1</code>.
</p>
</td></tr>
<tr valign="top"><td><code>beta</code></td>
<td>
<p>a fixed matrix that is multiplied to the return value of the
given function; the dimension must match.
Defining a vector valued function and <code>beta</code> as a vector,
an arbitrary linear model can be defined. Estimation of <code>beta</code>
is, however, not established yet.
</p>
</td></tr>
<tr valign="top"><td><code>coordnames</code></td>
<td>

<p>Just the names of the variables. More variable names might
be given here than used in the function.
See Details for the interpretation of variables.
</p>
</td></tr>
<tr valign="top"><td><code>fctn, fst, snd</code></td>
<td>
<p>a user-defined function and its first,
second and third derivative, given as
<code>quote(myfunction(x))</code> or as 
<code>quote(myfunction(x, y))</code>, see Details and Examples below.
</p>
</td></tr>
<tr valign="top"><td><code>envir</code></td>
<td>
<p>the environment where the given function shall be evaluated</p>
</td></tr>
<tr valign="top"><td><code>var,scale,Aniso,proj</code></td>
<td>
<p>optional arguments; same meaning for any
<code><a href="RMmodel.html">RMmodel</a></code>. If not passed, the above
covariance function remains unmodified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Primarily, a function is expected that depends on
a vector whose components, <i>x, y, z, T</i>, are given separately as
scalar quantities.
</p>
<p>Alternatively, the function might depend only on the first argument
given by <code>coordnames</code>.
</p>
<p>A kernel should depend on the first two arguments
given by <code>coordnames</code>.
</p>


<h3>Value</h3>

<p><code><a href="RMuser.html">RMuser</a></code> returns an object of class
<code><a href="RMmodel-class.html">RMmodel</a></code>.
</p>


<h3>Note</h3>


<ul>
<li>
<p>The use of <code>RMuser</code> is completely on the risk of the
user. There is no 
way to check whether the expressions of the user are
correct in any sense.
</p>
</li>
<li>
<p>Note that <code>x</code>, <code>y</code>, <code>z</code> and <code>T</code> are reserved
argument names that define solely the coordinates.
Hence, none of these names might be used for
other arguments within these functions.
</p>
</li>
<li>
<p>In user-defined functions, the models of
<span class="pkg">RandomFields</span> are not recognized, so they cannot be included
in the function definitions.
</p>
</li>
<li>
<p><code><a href="RMuser.html">RMuser</a></code> may not be used in connection with obsolete
commands of RandomFields.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>See Also</h3>

<p><code><a href="RMcovariate.html">RMcovariate</a></code>,
<code><a href="RMfix.html">RMfixcov</a></code>,
<code><a href="RFfit.html">RFfit</a></code>,
<code><a href="RMmodelgenerator-class.html">RMmodelgenerator</a></code>,
<code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<a href="RC.html">RC_ISO_NAMES</a>, <a href="RC.html">RC_DOMAIN_NAMES</a>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

## Alternatively to 'model &lt;- RMexp()' one may define the following
## (which is, however, much slower and cannot use all features of
## RandomFields)

## user-defined exponential covariance model
model &lt;- RMuser(type="positive definite", domain="single variable",
                iso="isotropic", fctn=exp(-x))
x &lt;- y &lt;- seq(1, 10, len=100)
plot(model)
z &lt;- RFsimulate(model, x=x, y=y)
plot(z)

## the kernel, which is the scalar product (see RMprod)
model &lt;- RMnugget(var=1e-5) +
         RMuser(type="positive definite", domain="kernel",
                iso="symmetric", fctn=sum(x * y))
x &lt;- y &lt;- seq(1, 10, len=35)
z &lt;- RFsimulate(model, x=x, y=y, n=6, svdtol=1e-9) 
plot(z)
</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
