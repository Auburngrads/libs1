<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Matrix operator</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RMmatrix {RandomFields}"><tr><td>RMmatrix {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Matrix operator</h2>

<h3>Description</h3>

<p><code><a href="RMmatrix.html">RMmatrix</a></code> is a multivariate covariance model
depending on one multivariate covariance model, or
one or several univariate covariance models <i>C0,&hellip;</i>.
The corresponding covariance function is given by
</p>
<p style="text-align: center;"><i> C(h) = M phi(h) M^t</i></p>

<p>if a multivariate case is given. Otherwise it returns a matrix
whose diagonal elements are filled with the univarate model(s)
<code>C0</code>, <code>C1</code>, etc, and the
offdiagonals are all zero.
</p>


<h3>Usage</h3>

<pre>
RMmatrix(C0, C1,  C2, C3, C4, C5, C6, C7, C8, C9, M, vdim,
         var, scale, Aniso, proj)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>C0</code></td>
<td>
<p>a k-variate covariance <code><a href="RMmodel.html">RMmodel</a></code>
or a univariate model or a list of models joined by
<code><a href="QMath.html">c</a></code>
</p>
</td></tr>
<tr valign="top"><td><code>C1,C2,C3,C4,C5,C6,C7,C8,C9</code></td>
<td>
<p>optional univariate models</p>
</td></tr>
<tr valign="top"><td><code>M</code></td>
<td>
<p>a k times k matrix, which is multiplied from left and right to
the given model; <i>M</i> may depend on the location, hence it is then a
matrix-valued function and <i>C</i> will be non-stationary with
</p>
<p style="text-align: center;"><i> C(x, y) = M(x) phi(x, y) M(y)^t</i></p>
</td></tr>
<tr valign="top"><td><code>vdim</code></td>
<td>
<p>positive integer. This argument should be given if and only
if a multivariate model is created from a single univariate model and
<code>M</code> is not given. (In fact, if <code>M</code> is given, <code>vdim</code> must
equal the number of columns of <code>M</code>)</p>
</td></tr>
<tr valign="top"><td><code>var,scale,Aniso,proj</code></td>
<td>
<p>optional arguments; same meaning for any
<code><a href="RMmodel.html">RMmodel</a></code>. If not passed, the above
covariance function remains unmodified.</p>
</td></tr>
</table>




<h3>Value</h3>

<p><code><a href="RMmatrix.html">RMmatrix</a></code> returns an object of class
<code><a href="RMmodel-class.html">RMmodel</a></code>.</p>


<h3>Note</h3>







<ul>
<li><p><code>RMmatrix</code> also allows variogram models are arguments.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<code><a href="RFfit.html">RFfit</a></code>.
</p>


<h3>Examples</h3>

<pre>

RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again


## Not run: 
## first example: bivariate Linear Model of Coregionalisation
x &lt;- y &lt;- seq(0, 10, 0.2)

model1 &lt;- RMmatrix(M = c(0.9, 0.43), RMwhittle(nu = 0.3)) + 
  RMmatrix(M = c(0.6, 0.8), RMwhittle(nu = 2))
plot(model1)
simu1 &lt;- RFsimulate(RPdirect(model1), x, y)
plot(simu1)


## second, equivalent way of defining the above model
model2 &lt;- RMmatrix(M = matrix(ncol=2, c(0.9, 0.43, 0.6, 0.8)),
                  c(RMwhittle(nu = 0.3), RMwhittle(nu = 2)))
simu2 &lt;- RFsimulate(RPdirect(model2), x, y)
stopifnot(all.equal(as.array(simu1), as.array(simu2)))


## third, equivalent way of defining the above model
model3 &lt;- RMmatrix(M = matrix(ncol=2, c(0.9, 0.43, 0.6, 0.8)),
                   RMwhittle(nu = 0.3), RMwhittle(nu = 2))
simu3 &lt;- RFsimulate(RPdirect(model3), x, y)
stopifnot(all(as.array(simu3) == as.array(simu2)))

## End(Not run)


## second example: bivariate, independent fractional Brownian motion
## on the real axis
x &lt;- seq(0, 10, 0.1) 
modelB &lt;- RMmatrix(c(RMfbm(alpha=0.5), RMfbm(alpha=1.5))) ## see the Note above
print(modelB)
simuB &lt;- RFsimulate(modelB, x)
plot(simuB)


## third example: bivariate non-stationary field with exponential correlation
## function. The variance of the two components is given by the
## variogram of fractional Brownian motions.
## Note that the two components have correlation 1.
x &lt;- seq(0, 10, 0.1)
modelC &lt;- RMmatrix(RMexp(), M=c(RMfbm(alpha=0.5), RMfbm(alpha=1.5))) 
print(modelC)
simuC &lt;- RFsimulate(modelC, x, x, print=1)
#print(as.vector(simuC))
plot(simuC)


</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
