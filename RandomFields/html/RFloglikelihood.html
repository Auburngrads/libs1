<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Likelihood and estimation of linear models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RFloglikelihood {RandomFields}"><tr><td>RFloglikelihood {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Likelihood and estimation of linear models</h2>

<h3>Description</h3>

<p><code><a href="RFloglikelihood.html">RFloglikelihood</a></code> returns the log likelihood for Gaussian
random fields. In case NAs are given that refer to linear modeling, the
ML of the linear model is returned.
</p>


<h3>Usage</h3>

<pre>
RFlikelihood(model, x, y = NULL, z = NULL, T = NULL, grid = NULL,
                data, params, distances, dim, likelihood,
                estimate_variance =NA, ...) 

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>model,params</code></td>
<td>
<p> object of class  <code><a href="RMmodel-class.html">RMmodel</a></code>, <code><a href="RFformula.html">RFformula</a></code> or  <code><a href="../../stats/html/formula.html">formula</a></code>; best is to consider the examples below, first. <br /> The argument <code>params</code> is a list that specifies free parameters in a formula description, see <a href="RFformula.html">RMformula</a>.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>vector of x coordinates, or object of class <code><a href="../../sp/html/GridTopology-class.html">GridTopology</a></code> or <code><a href="../../raster/html/raster.html">raster</a></code>; for more options see <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>y,z</code></td>
<td>
<p>optional vectors of y (z) coordinates, which should not be given if <code>x</code> is a matrix.</p>
</td></tr>
<tr valign="top"><td><code>T</code></td>
<td>
<p>optional vector of time coordinates, <code>T</code> must always be an equidistant vector. Instead of <code>T=seq(from=From, by=By, len=Len)</code>, one may also write <code>T=c(From, By, Len)</code>.</p>
</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
<p>logical; the function finds itself the correct value in nearly all cases, so that usually <code>grid</code> need not be given. See also <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>distances,dim</code></td>
<td>
<p>another alternative for the argument <code>x</code> to pass the (relative) coordinates, see <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>matrix, data.frame or object of class <code><a href="RFsp-class.html">RFsp</a></code>; <br /> If a matrix is given the ordering of the colums is the following: space, time, multivariate, repetitions, i.e. the index for the space runs the fastest and that for repetitions the slowest.</p>
</td></tr>
</table>

<table summary="R argblock">
<tr valign="top"><td><code>likelihood</code></td>
<td>
<p> Not programmed yet. Character.
Choice of kind of likelihood (&quot;full&quot;, &quot;composite&quot;, etc.),
see also <code>likelihood</code> for <code><a href="RFfit.html">RFfit</a></code>
in <code><a href="RFoptions.html">RFoptions</a></code>.
</p>
</td></tr>
</table>


<table summary="R argblock">
<tr valign="top"><td><code>estimate_variance</code></td>
<td>
<p>logical or <code>NA</code>. See Details.
</p>
</td></tr> 
<tr valign="top"><td><code>...</code></td>
<td>
<p>for advanced use: further options and control arguments for the simulation that are passed to and processed by <code><a href="RFoptions.html">RFoptions</a></code>. If <code>params</code> is given, then <code>...</code> may include also the variables used in <code>params</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the likelihood for data of a Gaussian process
with given covariance structure.
The covariance structure may not have <code>NA</code> values in the
parameters except for a global variance. In this case the variance
is returned that maximizes the likelihood.
Additional to the covariance structure the model may include a
trend. The latter may contain unknown linear parameters.
In this case again, the unknown parameters are estimated, and returned.
</p>


<h3>Value</h3>

<p><code><a href="RFloglikelihood.html">RFloglikelihood</a></code> returns a list
containing the likelihood, the log likelihood, and
the global variance (if estimated &ndash; see details).
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>See Also</h3>

	
<p><a href="Bayesian.html">Bayesian</a>,
<code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFfit.html">RFfit</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<code><a href="RFlinearpart.html">RFlinearpart</a></code>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again


requireNamespace("mvtnorm")

pts &lt;- 4
repet &lt;- 3
model &lt;- RMexp()
x &lt;- runif(n=pts, min=-1, max=1)
y &lt;- runif(n=pts, min=-1, max=1)
dta &lt;- as.matrix(RFsimulate(model, x=x, y=y, n=repet, spC = FALSE))
print(cbind(x, y, dta))
print(system.time(likeli &lt;- RFlikelihood(model, x, y, data=dta)))
str(likeli, digits=8)

L &lt;- 0
C &lt;- RFcovmatrix(model, x, y)
for (i in 1:ncol(dta)) {
  print(system.time(dn &lt;- mvtnorm::dmvnorm(dta[,i], mean=rep(0, nrow(dta)),
sigma=C, log=TRUE)))
  L &lt;- L + dn
}
print(L)
stopifnot(all.equal(likeli$log, L))






pts &lt;- 4
repet &lt;- 1
trend &lt;- 2 * sin(R.p(new="isotropic")) + 3
#trend &lt;- RMtrend(mean=0)
model &lt;- 2 * RMexp() + trend
x &lt;- seq(0, pi, len=pts)
dta &lt;- as.matrix(RFsimulate(model, x=x, n=repet, spC = FALSE))
print(cbind(x, dta))

print(system.time(likeli &lt;- RFlikelihood(model, x, data=dta)))
str(likeli, digits=8)

L &lt;- 0
tr &lt;- RFfctn(trend, x=x, spC = FALSE)
C &lt;- RFcovmatrix(model, x)
for (i in 1:ncol(dta)) {
  print(system.time(dn &lt;- mvtnorm::dmvnorm(dta[,i], mean=tr, sigma=C,log=TRUE)))
  L &lt;- L + dn
}
print(L)

stopifnot(all.equal(likeli$log, L))







pts &lt;- c(3, 4)
repet &lt;- c(2, 3)
trend &lt;- 2 * sin(R.p(new="isotropic")) + 3
model &lt;- 2 * RMexp() + trend
x &lt;- y &lt;- dta &lt;- list()
for (i in 1:length(pts)) {
  x[[i]] &lt;- list(x = runif(n=pts[i], min=-1, max=1),
                 y = runif(n=pts[i], min=-1, max=1))
  dta[[i]] &lt;- as.matrix(RFsimulate(model, x=x[[i]]$x, y=x[[i]]$y,
                                    n=repet[i], spC = FALSE))
}

print(system.time(likeli &lt;- RFlikelihood(model, x, data=dta)))
str(likeli, digits=8)

L &lt;- 0
for (p in 1:length(pts)) {
  tr &lt;- RFfctn(trend, x=x[[p]]$x, y=x[[p]]$y,spC = FALSE)
  C &lt;- RFcovmatrix(model, x=x[[p]]$x, y=x[[p]]$y)
  for (i in 1:ncol(dta[[p]])) {
    print(system.time(dn &lt;- mvtnorm::dmvnorm(dta[[p]][,i], mean=tr, sigma=C,
                                    log=TRUE)))
    L &lt;- L + dn
  }
}
print(L)
stopifnot(all.equal(likeli$log, L))

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
