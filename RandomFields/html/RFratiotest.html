<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Likelihood ratio test</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RFratiotest {RandomFields}"><tr><td>RFratiotest {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Likelihood ratio test</h2>

<h3>Description</h3>

<p>The function performs an approximate chi2 test or
a Monte Carlo likelihood ratio test
based on <code><a href="fitgauss.html">fitgauss</a></code>. Currently, it only works for
Gaussian random fields.
</p>


<h3>Usage</h3>

<pre>
RFratiotest(nullmodel, alternative, x, y = NULL, z = NULL, T = NULL,
            grid=NULL, data, alpha, n = 5 / alpha, seed = 0, 
            lower = NULL, upper = NULL, methods,
            sub.methods, optim.control = NULL, users.guess = NULL,
            distances = NULL, dim, transform = NULL, ...)
</pre>


<h3>Arguments</h3>

  
<table summary="R argblock">
<tr valign="top"><td><code>nullmodel, alternative</code></td>
<td>
<p>See Details.
</p>
<p>The set of parameters 
to be estimated for <code>nullmodel</code>
should be a subset of the parameters to be estimated for
<code>alternative</code> if <code>alternative</code> is given.
</p>
</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
<p>value in [0,1] or missing. Significance level.
</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>integer. The test is based on <code>n-1</code> simulations.</p>
</td></tr>
<tr valign="top"><td><code>seed</code></td>
<td>
<p>integer. If not <code>NULL</code> and not <code>NA</code>, the
<a href="../../base/html/.Random.seed.html">.Random.seed</a> is set to <code>seed</code>. Otherwise,
<code><a href="../../base/html/set.seed.html">set.seed</a></code> is set to the value of 
<code>RFoptions{}$basic$seed</code>
if the latter is not <code>NA</code>.
</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>vector of x coordinates, or object of class <code><a href="../../sp/html/GridTopology-class.html">GridTopology</a></code> or <code><a href="../../raster/html/raster.html">raster</a></code>; for more options see <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>y,z</code></td>
<td>
<p>optional vectors of y (z) coordinates, which should not be given if <code>x</code> is a matrix.</p>
</td></tr>
<tr valign="top"><td><code>T</code></td>
<td>
<p>optional vector of time coordinates, <code>T</code> must always be an equidistant vector. Instead of <code>T=seq(from=From, by=By, len=Len)</code>, one may also write <code>T=c(From, By, Len)</code>.</p>
</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
<p>logical; the function finds itself the correct value in nearly all cases, so that usually <code>grid</code> need not be given. See also <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>matrix, data.frame or object of class <code><a href="RFsp-class.html">RFsp</a></code>; <br /> If a matrix is given the ordering of the colums is the following: space, time, multivariate, repetitions, i.e. the index for the space runs the fastest and that for repetitions the slowest.</p>
</td></tr>
<tr valign="top"><td><code>lower</code></td>
<td>
<p>list or vector. Lower bounds for the parameters. If <code>lower</code> is a vector, <code>lower</code> has to be a vector as well and its length must equal the number of parameters to be estimated. The order of <code>lower</code> has to be maintained. A component being <code>NA</code> means that no manual lower bound for the corresponding parameter is set. <br />  If <code>lower</code> is a list, <code>lower</code> has to be of (exactly) the same structure of the model.</p>
</td></tr>
<tr valign="top"><td><code>upper</code></td>
<td>
<p>list or vector. Upper bounds for the parameters. See <code>lower</code>.</p>
</td></tr>
<tr valign="top"><td><code>methods</code></td>
<td>
<p> Main methods to be used for estimating. If several methods are given, estimation will be performed with each method and the results reported.</p>
</td></tr> 
<tr valign="top"><td><code>sub.methods</code></td>
<td>
<p>variants of the least squares fit of the variogram. variants of the maximum likelihood fit of the covariance function. See <a href="RFfit.html">RFfit</a> for details.</p>
</td></tr>
<tr valign="top"><td><code>users.guess</code></td>
<td>
<p> User's guess of the parameters. All the parameters must be given using the same rules as for <code>lower</code> (except that no NA's should be contained).</p>
</td></tr>
<tr valign="top"><td><code>distances,dim</code></td>
<td>
<p>another alternative for the argument <code>x</code> to pass the (relative) coordinates, see <a href="RFsimulateAdvanced.html">RFsimulateAdvanced</a>.</p>
</td></tr>
<tr valign="top"><td><code>optim.control</code></td>
<td>
<p>control list for <code><a href="../../stats/html/optim.html">optim</a></code>, which uses &lsquo;L-BFGS-B&rsquo;. However <code>parscale</code> may not be given.</p>
</td></tr>
<tr valign="top"><td><code>transform</code></td>
<td>
<p>obsolete for users; use <code>param</code> instead. <code>transform=list()</code> will return structural information to set up the correct function.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>for advanced use: further options and control arguments for the simulation that are passed to and processed by <code><a href="RFoptions.html">RFoptions</a></code>. If <code>params</code> is given, then <code>...</code> may include also the variables used in <code>params</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>nullmodel</code> (and the <code>alternative</code>) can be
</p>

<ul>
<li>
<p>a covariance model, see <code><a href="RMmodel.html">RMmodel</a></code> or
type <code><a href="RFgetModelNames.html">RFgetModelNames</a>(type="variogram")</code> to get all options.
</p>
<p>If <code><a href="RFoptions.html">RFoptions</a></code>
<code>ratiotest_approx</code> is <code>TRUE</code> the chisq approximation is performed. Otherwise 
a Monte Carlo ratio test is performed.
</p>
</li>
<li>
<p><code><a href="RFfit-class.html">RFfit</a></code> or
<code><a href="RMmodelExt-class.html">RMmodelFit</a></code>
</p>
<p>Here, a chisq approximative test is always performed on the
already fitted models.
</p>
</li></ul>

<p><code>RFratiotest</code> tries to detect whether
<code>nullmodel</code> is a submodel of <code>alternative</code>.
If it fails,
</p>

<ul>
<li><p> a message is printed that says that an
<em>automatic</em> detection has not been possible;
</p>
</li>
<li><p> it is not guaranteed anymore that the <code>alternative</code> model
returns a (log) likelihood that is at least as large as
that of the <code>nullmodel</code>,
even if <code>nullmodel</code> is a submodel of <code>alternative</code>.
This is due to numerical optimisation which is never perfect.       
</p>
</li></ul>

<p>Otherwise it is guaranteed that the <code>alternative</code> model has
a (log) likelihood that is at least as large as that of the <code>nullmodel</code>.
</p>


<h3>Value</h3>

<p>The test returns a message whether the null hypothesis, i.e. the
smaller model is accepted.
Invisibly, a list that also contains
</p>

<ul>
<li> <p><code>p</code>, the <i>p</i>-value
</p>
</li>
<li> <p><code>n</code>
</p>
</li>
<li> <p><code>data.ratio</code> the log ratio for the data
</p>
</li>
<li> <p><code>simu.ratio</code> the log ratio for the simulations
</p>
</li>
<li> <p><code>data.fit</code> the models fitted to the data
</p>
</li>
<li> <p><code>msg</code> the message that is also directly returned
</p>
</li></ul>

<p>It has S3 class <code>"RFratiotest"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>print</dt><dd><p>prints the summary</p>
</dd>
<dt>summary</dt><dd><p>gives a summary</p>
</dd>
</dl>



<h3>Note</h3>

<p>An important <code><a href="RFoptions.html">RFoptions</a></code> is <code>ratiotest_approx</code>.
</p>


<h3>Note</h3>

<p>Note that the likelihood ratio test may take a huge amount of time.
</p>


<h3>Note</h3>

<p>This function does not depend on the value of
<code><a href="RFoptions.html">RFoptions</a></code><code>()$PracticalRange</code>. The function <code>RFratiotest</code> always uses the standard specification
of the covariance model as given in <code><a href="RMmodel.html">RMmodel</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>See Also</h3>

<p><code><a href="RFfit.html">RFfit</a></code>,
<code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RandomFields.html">RandomFields</a></code>,
<code><a href="weather.html">weather</a></code>.
</p>


<h3>Examples</h3>

<pre>


</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
