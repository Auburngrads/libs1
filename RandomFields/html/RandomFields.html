<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Simulation and Analysis of Random Fields</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RandomFields-package {RandomFields}"><tr><td>RandomFields-package {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Simulation and Analysis of Random Fields</h2>

<h3>Description</h3>

 
<p>The package <code>RandomFields</code> offers various tools for
</p>

<ol>
<li><p><b>model estimation (ML) and inference (tests)</b>
for regionalized variables and data analysis,
</p>
</li>
<li><p><b>simulation</b> of different kinds
of random fields, including
</p>

<ul>
<li><p> multivariate, spatial, spatio-temporal, and non-stationary
Gaussian random fields,
</p>
</li>
<li><p> Poisson fields, binary fields, Chi2 fields, t fields and
</p>
</li>
<li><p> max-stable fields.
</p>
</li></ul>

<p>It can also deal with non-stationarity and anisotropy of these
processes and conditional simulation (for Gaussian random fields,
currently). 
</p>

</li></ol>

<p>See <a href="http://ms.math.uni-mannheim.de/de/publications/software/">http://ms.math.uni-mannheim.de/de/publications/software/</a>
for <b>intermediate updates</b>.
</p>


<h3>Details</h3>

<p>The following features are provided by the package:
</p>

<ol>
<li> <p><b>Bayesian Modelling</b>
</p>

<ul>
<li><p> See <a href="Bayesian.html">Bayesian Modelling</a> for an introduction to
hierarchical modelling. 
</p>
</li></ul>

</li>
<li> <p><b>Coordinate systems</b>
</p>

<ul>
<li><p> Cartesian, earth and spherical coordinates are
recognized, see <a href="CoordinateSystems.html">coordinate systems</a> for details.
</p>
</li>
<li><p> A list of valid models is given by
<a href="RMmodelsSphere.html">spherical models</a>.
</p>
</li></ul>

</li>
<li> <p><b>Data and example studies</b>:
Some data sets and published code are provided to illustrate the
syntax and structure of the package functions. 
</p>

<ul>
<li> <p><code><a href="soil.html">soil</a></code> : soil physical data
</p>
</li>
<li> <p><code><a href="weather.html">weather</a></code> : UWME weather data
</p>
</li>
<li> <p><code><a href="papers.html">papers</a></code> : code used in the papers published by
the author(s)
</p>
</li></ul>

</li>
<li> <p><b>Estimation of parameters (for second-order random fields)</b>
</p>
 
<ul>
<li> <p><code><a href="RFfit.html">RFfit</a></code> : general function for estimating
parameters; (for Gaussian random fields)
</p>
</li>
<li> <p><code><a href="RFhurst.html">RFhurst</a></code> : estimation of the Hurst parameter
</p>
</li>
<li> <p><code><a href="RFfractaldim.html">RFfractaldim</a></code> : estimation of the fractal
dimension  
</p>
</li>
<li> <p><code><a href="RFvariogram.html">RFvariogram</a></code> : calculates
the empirical variogram 
</p>
</li>
<li> <p><code><a href="RFcov.html">RFcov</a></code> : calculates
the empirical (auto-)covariance function
</p>
</li></ul>

</li>
<li> <p><b>Graphics</b>
</p>

<ul>
<li><p> Fitting a covariance function manually
<code><a href="RFgui.html">RFgui</a></code>
</p>
</li>
<li><p> the generic function <code><a href="../../graphics/html/plot.html">plot</a></code>
</p>
</li>
<li><p> global graphical parameters with <code><a href="RFpar.html">RFpar</a></code>
</p>
</li></ul>

</li>
<li> <p><b>Inference (for Gaussian random fields)</b> 
</p>

<ul>
<li> <p><code><a href="RFcrossvalidate.html">RFcrossvalidate</a></code> : cross validation
</p>
</li>
<li> <p><code><a href="RFloglikelihood.html">RFlikelihood</a></code> : likelihood
</p>
</li>
<li> <p><code><a href="RFratiotest.html">RFratiotest</a></code> : likelihood ratio test
</p>
</li>
<li> <p><code><a href="RFfit-class.html">AIC</a></code>, 
<code><a href="RFfit-class.html">AICc</a></code>,
<code><a href="RFfit-class.html">BIC</a></code>, <code><a href="RFfit-class.html">anova</a></code>,
<code><a href="RFfit-class.html">logLik</a></code>
</p>
</li></ul>

</li>
<li> <p><b>Models</b>
</p>

<ul>
<li><p> For an introduction and general properties, see
<a href="RMmodel.html">RMmodels</a>.
</p>
</li>
<li><p> For an overview over classes of
covariance and variogram models &ndash;e.g. for
<b>geostatistical</b> purposes&ndash; see <a href="RM.html">RM</a>. More
sophisticated models 
and covariance function operators are included. 


</p>
</li>
<li> <p><code><a href="RFformula.html">RFformula</a></code> reports a new style of passing a
model since version 3.3.
</p>
</li>
<li><p> definite models are evaluated by <code><a href="RFcov.html">RFcov</a></code>,
<code><a href="RFvariogram.html">RFvariogram</a></code> and <code><a href="RFcovmatrix.html">RFcovmatrix</a></code>.
For a quick impression use <code><a href="../../graphics/html/plot.html">plot</a>(model)</code>.
</p>
</li>
<li><p> non-definite models are evaluated by <code><a href="RFfctn.html">RFfctn</a></code> and
<code><a href="QMath.html">RFcalc</a></code>
</p>
</li>
<li> <p><code><a href="RFlinearpart.html">RFlinearpart</a></code> returns the linear part of a
model
</p>
</li>
<li> <p><code><a href="RFboxcox.html">RFboxcox</a></code> deals explicitly with Box-Cox
transformations. In many cases it is performed implicitly.
</p>
</li></ul>

</li>
<li> <p><b>Prediction (for second-order random fields)</b> 
</p>

<ul>
<li> <p><code><a href="RFinterpolate.html">RFinterpolate</a></code> : kriging, including imputing
</p>
</li></ul>

</li>
<li> <p><b>Simulation</b>
</p>

<ul>
<li> <p><code><a href="RFsimulate.html">RFsimulate</a></code>: Simulation
of random fields,
including conditional simulation. For a list of all covariance
functions and variogram models see <code><a href="RM.html">RM</a></code>.
Use <code><a href="../../graphics/html/plot.html">plot</a></code> for visualisation of the result.
</p>
</li></ul>

</li>
<li> <p><b>S3 and S4 objects</b>
</p>
      
<ul>
<li><p> The functions return S4 objects
based on the package <span class="pkg">sp</span>,
if <code><a href="RFoptions.html">spConform=TRUE</a></code>.
This is the default.
</p>
<p>If <code><a href="RFoptions.html">spConform=FALSE</a></code>,
simple objects as in version 2 are returned. 
These simple objects are frequently provided with an S3 class.
This option makes the returning procedure much faster, but
currently does not allow for the comfortable use of
<code><a href="plot-method.html">plot</a></code>.
</p>
</li>
<li> <p><code><a href="../../graphics/html/plot.html">plot</a></code>,
<code><a href="../../base/html/print.html">print</a></code>, <code><a href="../../base/html/summary.html">summary</a></code>,
sometimes also <code><a href="../../utils/html/str.html">str</a></code> recognise these S3 and S4
objects
</p>
</li>
<li><p> use <code><a href="sp2RF.html">sp2RF</a></code> for an explicit transformation
of <span class="pkg">sp</span> objects to S4 objects of <span class="pkg">RandomFields</span>.
</p>
</li>
<li>
<p>Further generic functions are available for fitted models,
see &lsquo;Inference&rsquo; above. 
</p>




</li></ul>

</li>
<li>  <p><b>Xtended</b> features, especially for package programmers
</p>

<ul>
<li><p> might  decide on a large variety of arguments of the 
simulation and estimation procedures using the function
<code><a href="RFoptions.html">RFoptions</a></code>
</p>
</li>
<li><p> may use &lsquo;./configure
&ndash;with-tcl-config=/usr/lib/tcl8.5/tclConfig.sh
&ndash;with-tk-config=/usr/lib/tk8.5/tkConfig.sh&rsquo; to configure R
</p>
</li></ul>

</li></ol>



<h3>Changings</h3>

<p>A list of major changings from  Version 2 to Version 3 can be found
in <a href="MajorRevisions.html">MajorRevisions</a>.
</p>
<p><a href="Changings.html">Changings</a> lists some further changings, in particular of
argument and argument names.
</p>
<p><span class="pkg">RandomFields</span> should be rather
stable when running it with <span class="pkg">parallel</span>.
However <span class="pkg">RandomFields</span> might crash severely if an error occurs
when running in parallel. When used with <span class="pkg">parallel</span>,
you might set <code>RFoptions(cores = 1)</code>. Note that
<code>RFoptions(cores = ...)</code> with more than 1 core uses another level
of parallelism which will be in competetions with <span class="pkg">parallel</span>
during runtime.
</p>


<h3>Update</h3>

<p>Current updates are available through <a href="http://ms.math.uni-mannheim.de/de/publications/software">http://ms.math.uni-mannheim.de/de/publications/software</a>.
</p>


<h3>Contributions</h3>


<ul>
<li><p> Contributions to version 3.0 and following:<br />
Felix Ballani (TU Bergakademie Freiberg; Poisson Polygons, 2014) <br />
Daphne Boecker (Univ. Goettingen; RFgui, 2011)<br />   
Katharina Burmeister (Univ. Goettingen; testing, 2012)<br />
Sebastian Engelke (Univ. Goettingen; RFvariogram, 2011-12)<br />
Sebastian Gross (Univ. Goettingen; tilde formulae, 2011)<br />
Alexander Malinowski (Univ. Mannheim; S3, S4 classes 2011-13)<br />
Juliane Manitz (Univ. Goettingen; testing, 2012)<br />
Johannes Martini (Univ. Goettingen; RFvariogram,
2011-12)<br />
Ulrike Ober (Univ. Goettingen; help pages, testing, 2011-12)<br />
Marco Oesting (Univ. Mannheim; Brown-Resnick processes, Kriging, Trend,
2011-13)<br />
Paulo Ribeiro (Unversidade Federal do Parana; code adopted
from <span class="pkg">geoR</span>, 2014)<br />
Kirstin Strokorb (Univ. Mannheim; help pages, 2011-13)<br />
</p>
</li>
<li><p> Contributions to version 2.0 and following:<br />
Peter Menck (Univ. Goettingen; multivariate circulant embedding)<br />
R Core Team, Richard Singleton (fft.c and advice) 
</p>
</li>
<li><p> Contributions to version 1 and following:<br />
Ben Pfaff, 12167 Airport Rd, DeWitt MI 48820, USA making available
an algorithm for AVL trees (avltr*)
</p>
</li></ul>



<h3>Thanks</h3>

<p>Patrick Brown : comments on Version 3<br />
Paulo Ribeiro : comments on Version 1<br />
Martin Maechler : advice for Version 1
</p>


<h3>Financial support</h3>


<ul>
<li>
<p>V3.0 has been financially supported by the German Science Foundation
(DFG) through the Research Training Group 1953 &lsquo;Statistical
Modeling of Complex Systems and Processes &mdash; Advanced Nonparametric
Approaches&rsquo; (2013-2018).
</p>
</li>
<li>
<p>V3.0 has been financially supported by Volkswagen Stiftung within
the project &lsquo;WEX-MOP&rsquo; (2011-2014).
</p>
</li>
<li>
<p>Alpha versions for V3.0 have been
financially supported by the German Science Foundation (DFG) through the
Research Training Groups 1644 &lsquo;Scaling problems in Statistics&rsquo;
and 1023 &lsquo;Identification in Mathematical Models&rsquo; (2008-13).
</p>
</li>
<li>
<p>V1.0 has been financially supported by
the German Federal Ministry of Research and Technology 
(BMFT) grant PT BEO 51-0339476C during 2000-03.
</p>
</li>
<li>
<p>V1.0 has been financially supported by the EU TMR network
ERB-FMRX-CT96-0095 on
&ldquo;Computational and statistical methods for the analysis of spatial
data&rdquo; in 1999.
</p>
</li></ul>



<h3>Note</h3>

<p>The following packages enable further choices for the optimizer
(instead of <code>optim</code>) in RandomFields:
<span class="pkg">optimx</span>, <span class="pkg">soma</span>, <span class="pkg">GenSA</span>, <span class="pkg">minqa</span>, <span class="pkg">pso</span>,
<span class="pkg">DEoptim</span>, <span class="pkg">nloptr</span>, <span class="pkg">RColorBrewer</span>, <span class="pkg">colorspace</span>
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>References</h3>


<ul>
<li>
<p>Singleton, R.C. (1979). In <em>Programs for Digital Signal Processing</em> 
Ed.: Digital Signal Processing Committee and IEEE Acoustics,
Speech, and Signal Processing Committe (1979)
IEEE press.
</p>
</li>
<li>
<p>Schlather, M., Malinowski, A., Menck, P.J., Oesting, M. and
Strokorb, K. (2015) 
Analysis, simulation and prediction of multivariate
random fields with package <span class="pkg">RandomFields</span>. <em>
Journal of Statistical Software</em>, <b>63</b> (8), 1-25,
url          = &lsquo;http://www.jstatsoft.org/v63/i08/&rsquo;
</p>
</li>
<li>
<p>see also the corresponding <a href="../doc/multivariate_jss.pdf">vignette</a>.
</p>
</li></ul>
 


<h3>See Also</h3>

<p>See also  <a href="RF.html">RF</a>, <a href="RM.html">RM</a>, <a href="RP.html">RP</a>, <a href="RR.html">RR</a>, <a href="RC.html">RC</a>, <a href="QMath.html">R.</a>
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

# simulate some data first (Gaussian random field with exponential
# covariance; 6 realisations)
model &lt;- RMexp()
x &lt;- seq(0, 10, 0.1)
z &lt;- RFsimulate(model, x, x, n=6)

## select some data from the simulated data
xy &lt;- coordinates(z)
pts &lt;- sample(nrow(xy), min(100, nrow(xy) / 2))
dta &lt;- matrix(nrow=nrow(xy), as.vector(z))[pts, ]
dta &lt;- cbind(xy[pts, ], dta)
plot(z, dta)


## re-estimate the parameter (true values are 1)
estmodel &lt;- RMexp(var=NA, scale=NA)
(fit &lt;- RFfit(estmodel, data=dta))

## show a kriged field based on the estimated parameters
kriged &lt;- RFinterpolate(fit, x, x, data=dta)
plot(kriged, dta)

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
