<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Method to simulate the Nugget effect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Independent Variables {RandomFields}"><tr><td>Independent Variables {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Method to simulate the Nugget effect</h2>

<h3>Description</h3>

<p>Method to simulate the Nugget effect. (Only for advanced users)
</p>


<h3>Usage</h3>

<pre>
RPnugget(phi, boxcox, tol, vdim)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>phi</code></td>
<td>
<p>object of class <code><a href="RMmodel-class.html">RMmodel</a></code>;
specifies the covariance model to be simulated. The only possible
model for <code>phi</code> is <code><a href="RMnugget.html">RMnugget</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>boxcox</code></td>
<td>
<p>the one or two parameters of the box cox transformation.
If not given, the globally defined parameters are used.
See <code><a href="RFboxcox.html">RFboxcox</a></code> for details.
</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>

<p>points at a distance less than or equal to <code>nugget.tol</code>
are considered as being identical. This strategy applies to
the simulation method and the covariance function itself.
Hence, the covariance function is only positive definite
if <code>nugget.tol=0.0</code>. However, if the anisotropy matrix
does not have full rank and <code>nugget.tol=0.0</code>, then
the simulations are likely to be odd. 
The value of <code>nugget.tol</code>
should be of order <i>1e-15</i>.
</p>
<p>Default: <code>0.0</code>
</p>
</td></tr>
<tr valign="top"><td><code>vdim</code></td>
<td>
<p>positive integer; the model is treated
<code>vdim</code>-variate, <code>vdim=1</code> (default) corresponds to a
univariate random field.
Mostly, the value of <code>vdim</code> is set automatically.
</p>
<p>Default is that it takes the value of the submodel <code>phi</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>General</dt><dd>
<p>This method only allows <code><a href="RMnugget.html">RMnugget</a></code> as a submodel.
</p>
</dd>
<dt>Anisotropy</dt><dd>
<p>The method also allows for zonal nugget effects. Only there the
argument <code>tol</code> becomes important.
For the zonal nugget effect, the anisotropy matrix <code>Aniso</code>
should be given in <code><a href="RMnugget.html">RMnugget</a></code>. There, only the
kernel of the 
matrix is important.
</p>
</dd>
<dt>Points close together</dt><dd>
<p>The 
locations at a distance less than or equal to the <a href="RFoptions.html">RFoptions</a>
<code>nugget.tol</code>
are considered as being identical. This strategy applies to
the simulation method and the covariance function itself.
Hence, the covariance function is only positive definite
if <code>nugget.tol=0.0</code>. However, if the anisotropy matrix
does not have full rank and <code>nugget.tol=0.0</code>, then the
simulations are likely to be odd.  
The value of <code>nugget.tol</code>
should be of order <i>1e-15</i>.
</p>
</dd>
<dt>Repeated measurements</dt><dd>
<p>Measurement errors are mathematically not distinguishable from spatial
nugget effects as long as measurements are not repeated at the very
same space-time
location. So there is no need to distinguish the spatial nugget
effect from a measurement error.
This is the default, see
<code>allow_duplicated_locations</code> in <a href="RFoptions.html">RFoptions</a>.
</p>
<p>In case several measurement have been taken in single space-time
locations,
measurement errors can be separated from spatial noise.
In this case <code>RMnugget()</code> models the measurement error (which
corresponds to a non-stationary model in an abstract space) by
default and the
measurement error model cannot be extended beyond the given
locations.
On the other hand <code>RMnugget(Ansio=something)</code> and
<code>RMnugget(proj=something)</code> model the spatial nugget effect
(with and without zonal anisotropy in case <code>Aniso</code> has low and
full rank respectively).
</p>
</dd>
<dt>Role of <code>RPnugget</code></dt><dd>
<p>Even for advanced users, there is no need to call
<code>RPnugget</code> directly, as this is done internally when
the <a href="RMnugget.html">RMnugget</a> is involved in the covariance model.
</p>
</dd>
</dl>



<h3>Value</h3>

<p><code>RPnugget</code> returns an object of class
<code><a href="RMmodel-class.html">RMmodel</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>References</h3>


<ul>
<li>
<p>Schlather, M. (1999) <em>An introduction to positive definite
functions and to unconditional simulation of random fields.</em>
Technical report ST 99-10, Dept. of Maths and Statistics,
Lancaster University. 
</p>
</li></ul>



<h3>See Also</h3>

 <p><a href="GaussianFields.html">Gaussian</a>,
<a href="RP.html">RP</a>,
<code><a href="RPcoin.html">RPcoins</a></code>,
<code><a href="RPhyperplane.html">RPhyperplane</a></code>,
<code><a href="RPspectral.html">RPspectral</a></code>,
<code><a href="RPtbm.html">RPtbm</a></code>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again


x &lt;- y &lt;- 1:2
xy &lt;- as.matrix(expand.grid(x, y)) ## we get 4 locations
## Standard use of the nugget effect
model &lt;- RMnugget(var = 100)
RFcovmatrix(model, x=xy)
as.vector(RFsimulate(model, x=x, y=x, tol=1e-10))

## zonal nugget effect, which is not along the axes
model &lt;- RMnugget(Aniso=matrix(1, nr=2, nc=2))
RFcovmatrix(model, x=xy)
as.vector(RFsimulate(model, x=x, y=x, tol=1e-10))


## All the following examples refer to repeated measurements
RFoptions(allow_duplicated_locations = TRUE) 
(xy &lt;- rbind(xy, xy)) ## now, the 4 locations are repeated twice 

## standard situation: the nugget is interpreted as measurement error:
model &lt;- RMnugget()
RFcovmatrix(model, x=xy)
as.matrix(RFsimulate(model, x=xy)) 

## any anisotropy matrix with full rank: spatial nugget effect
model &lt;- RMnugget(Aniso=diag(2))
RFcovmatrix(model, x=xy)
as.matrix(RFsimulate(model, x=xy))

## anisotropy matrix with lower rank: zonal nugget effect
model &lt;- RMnugget(Aniso=matrix(c(1, 0, 0, 0), nc=2))
RFcovmatrix(model, x=xy)
as.matrix(RFsimulate(model, x=xy))

## same as before: zonal nugget effect
model &lt;- RMnugget(Aniso=t(c(1,0)))
RFcovmatrix(model, x=xy)
as.matrix(RFsimulate(model, x=xy))
</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
