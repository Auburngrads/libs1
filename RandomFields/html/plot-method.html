<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Methods for function 'plot' in package 'RandomFields'</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plot-method {RandomFields}"><tr><td>plot-method {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Methods for function <code>plot</code> in package <span class="pkg">RandomFields</span></h2>

<h3>Description</h3>

<p>Plot methods are implemented for simulated random fields (objects of
class <code><a href="RFsp-class.html">RFsp</a></code>), explicit covariance models
(objects of class <code><a href="RMmodel-class.html">RMmodel</a></code>),  
empirical variograms (objects of class
<code><a href="RFempVariog-class.html">RFempVariog</a></code>) and fitted models
(objects of class <code><a href="RFfit-class.html">RFfit</a></code>).
</p>
<p>The plot methods not described here are described together with the
class itself, for instance,

<code><a href="RFfit-class.html">RFfit</a></code>,
<code><a href="RFempVariog-class.html">RFempVariog</a></code>
<code><a href="RMmodel-class.html">RMmodel</a></code>.
</p>


<h3>Usage</h3>

<pre>
RFplotSimulation(x, y, MARGIN=c(1,2), MARGIN.slices=NULL,
 n.slices = if (is.null(MARGIN.slices)) 1 else 10, nmax=6, 
 plot.variance = !is.null(x@.RFparams$has.variance) &amp;&amp; x@.RFparams$has.variance,
 select.variables, zlim, legend=TRUE,
 MARGIN.movie = NULL, file=NULL, speed = 0.3,
 height.pixel=300, width.pixel=height.pixel,
 ..., plotmethod="image")

RFplotSimulation1D(x, y, nmax=6,
  plot.variance=!is.null(x@.RFparams$has.variance) &amp;&amp; x@.RFparams$has.variance,
  legend=TRUE, ...)

## S4 method for signature 'RFgridDataFrame,missing'
plot(x, y, ...)
## S4 method for signature 'RFpointsDataFrame,missing'
plot(x, y, ...)
## S4 method for signature 'RFspatialGridDataFrame,missing'
plot(x, y, ...)
## S4 method for signature 'RFspatialPointsDataFrame,missing'
plot(x, y, ...)

## S4 method for signature 'RFgridDataFrame,matrix'
plot(x, y, ...)
## S4 method for signature 'RFpointsDataFrame,matrix'
plot(x, y, ...)
## S4 method for signature 'RFspatialGridDataFrame,matrix'
plot(x, y, ...)
## S4 method for signature 'RFspatialPointsDataFrame,matrix'
plot(x, y, ...)

## S4 method for signature 'RFgridDataFrame,data.frame'
plot(x, y, ...)
## S4 method for signature 'RFpointsDataFrame,data.frame'
plot(x, y, ...)
## S4 method for signature 'RFspatialGridDataFrame,data.frame'
plot(x, y, ...)
## S4 method for signature 'RFspatialPointsDataFrame,data.frame'
plot(x, y, ...)

## S4 method for signature 'RFgridDataFrame,RFgridDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFgridDataFrame,RFpointsDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFpointsDataFrame,RFgridDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFpointsDataFrame,RFpointsDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFspatialGridDataFrame,RFspatialGridDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFspatialGridDataFrame,RFspatialPointsDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFspatialPointsDataFrame,RFspatialGridDataFrame'
plot(x, y, ...)
## S4 method for signature 'RFspatialPointsDataFrame,RFspatialPointsDataFrame'
plot(x, y, ...)

## S4 method for signature 'RFspatialGridDataFrame'
persp(x, ..., zlab="")
## S3 method for class 'RFspatialGridDataFrame'
contour(x, ...)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>object of class <code><a href="RFsp-class.html">RFsp</a></code> or
<code><a href="RMmodel-class.html">RMmodel</a></code>; in the latter case, <code>x</code> can
be any sophisticated model but it must be either stationary or a
variogram model</p>
</td></tr> 
<tr valign="top"><td><code>y</code></td>
<td>
<p>ignored in most methods; in case of
<code>RFplotSimulation</code> data might be given</p>
</td></tr>
<tr valign="top"><td><code>MARGIN</code></td>
<td>
<p>vector of two; two integer values giving the coordinate
dimensions 
w.r.t. whether the field or the covariance model
is to be plotted; in all other directions,
the first index is taken</p>
</td></tr>
<tr valign="top"><td><code>MARGIN.slices</code></td>
<td>
<p>integer value; if <i>[space-time-dimension&gt;2]</i>,
<code>MARGIN.slices</code> can specify a third dimension w.r.t. which a
sequence of slices is plotted. Currently only works for grids.</p>
</td></tr> 
</table>



<table summary="R argblock">
<tr valign="top"><td><code>n.slices</code></td>
<td>
<p>integer value. 
The number of slices to be plotted; if
<code>n.slices&gt;1</code>, <code>nmax</code> is set to 1. Or <code>n.slices</code> is a
vector of 3 elements: start, end, length. Currently only works for grids.</p>
</td></tr>
<tr valign="top"><td><code>nmax</code></td>
<td>
<p>the maximal number of the <code>x@.RFparams$n</code> iid copies
of the field that are to be plotted</p>
</td></tr>
<tr valign="top"><td><code>MARGIN.movie</code></td>
<td>
<p>integer. If given a sequence of figures is shown for this
direction. This option is in an experimental stage.
It works only for grids.
</p>
</td></tr>
<tr valign="top"><td><code>file, speed, height.pixel, width.pixel</code></td>
<td>

<p>In case <code>MARGIN.movie</code> and <code>file</code> is given an 'avi' movie
is stored using the <code>mencoder</code> command with speed argument
<code>speed</code>. As temporary files <code>file__###.png</code>  
of size <code>width.pixel</code> x <code>height.pixel</code> are created.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>arguments to be passed to methods; mainly graphical
arguments, or further models in case of class <code>CLASS_CLIST</code>,
see Details.
</p>
</td></tr>
</table>























<table summary="R argblock">
<tr valign="top"><td><code>plot.variance</code></td>
<td>
<p>logical, whether variances should be plotted if
available</p>
</td></tr>
<tr valign="top"><td><code>select.variables</code></td>
<td>
<p>vector of integers or list of vectors.
The argument is only of interest for multivariate models.
Here, <code>length(select.variables)</code> gives the number of pictures shown
(excluding the plot for the variances, if applicable).
If <code>select.variables</code> is a vector of integers then exactly these
components are shown. If <code>select.variables</code> is a list, each element
should be a vector up to length <i>l &lt;= 3</i>:
</p>

<ul>
<li> <p><i>l=1</i><br /> the component is shown in the usual way
</p>
</li>
<li> <p><i>l=2</i> <br /> the two components are interpreted as vector and
arrows are plotted
</p>
</li>
<li> <p><i>l=3</i> <br /> the first component is shown as single component;
the remaining two component are interpreted as a vector and
plotted into the picture of the first component 
</p>
</li></ul>

</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>logical, whether a legend should be plotted</p>
</td></tr>
<tr valign="top"><td><code>zlim</code></td>
<td>
<p>vector of length 2 with the usual meaning.
In case of multivariate random fields, <code>zlim</code> can also be a character
with the value &lsquo;joint&rsquo; indicating that all plotted components shall
have the same zlim OR a matrix with two rows, where the i-th column
gives the zlim of the i-th variable OR a list with entries named
<code>data</code> and <code>var</code> if a separate <code>zlim</code>
for the Kriging variance is to
be used.</p>
</td></tr>
<tr valign="top"><td><code>plotmethod</code></td>
<td>
<p>string or function. Internal.
</p>
</td></tr>
<tr valign="top"><td><code>zlab</code></td>
<td>
<p>character. See <code><a href="../../graphics/html/persp.html">persp</a></code></p>
</td></tr>
</table>




<h3>Details</h3>

<p>Internally, <code>...</code> are passed to <code>image</code> and
<code>plot.default</code>, respectively; if, by default, multiple colors,
xlabs or ylabs are used, also vectors of suitable length can be
passed as <code>col</code>, <code>xlab</code> and <code>ylab</code>, respectively.
</p>
<p>One exception is the use of <code>...</code> in <code>plot</code> for class
<code>CLASS_CLIST</code>.
Here, further models might be passed. All models must have names
starting with <code>model</code>. If <code>'.'</code> is following in the name,
the part of the name after the dot is shown in the legend. Otherwise
the name is ignored and a standardized name derived from the model
definition is shown in the legend. Note that for the first argument
a name cannot be specified.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "RFspatialGridDataFrame", y =
 "missing")</code></dt><dd><p>Generates nice image plots of simulation results for
simulation on a grid and space-time-dimension <i>&gt;1</i>. If
space-time-dimension <i>&gt;2</i>, plots are on 2-dimensional
subspaces. 
Handles multivariate random fields (<code>.RFparams$vdim&gt;1</code>) as well as
repeated iid simulations (<code>.RFparams$vdim&gt;n</code>).</p>
</dd>
<dt><code>signature(x = "RFspatialGridDataFrame", y =
 "RFspatialPointsDataFrame")</code></dt><dd>
<p>Similar to method for <code>y="missing"</code>, but additionally adds the
points of <code>y</code>. Requires <code>MARGIN.slices=NULL</code> and 
<code>all.equal(x@.RFparams, y@.RFparams)</code>.</p>
</dd>
<dt><code>signature(x = "RFspatialGridDataFrame", y =
 "matrix")</code></dt><dd>
<p>Similar to method for <code>y="missing"</code>, but additionally adds the
points of <code>y</code>. Requires <code>MARGIN.slices=NULL</code> and 
<code>all.equal(x@.RFparams, y@.RFparams)</code>.</p>
</dd>
<dt><code>signature(x = "RFspatialPointsDataFrame", y =
 "RFspatialGridDataFrame")</code></dt><dd>
<p>Throws an error. Probably <code>x</code> and <code>y</code> have been interchanged.</p>
</dd>
<dt><code>signature(x = "RFspatialPointsDataFrame", y =
 "missing")</code></dt><dd><p>Similar to method for class
<code><a href="RFspatialGridDataFrame-class.html">RFspatialGridDataFrame</a></code>, but for non-gridded simulation results.
Instead of a grid, only existing points are plotted with colors indicating
the value of the random field at the respective location. Handles
multivariate random fields (<code>.RFparams$vdim&gt;1</code>) as well as
repeated iid simulations (<code>.RFparams$vdim&gt;n</code>).</p>
</dd>
<dt><code>signature(x = "RFspatialPointsDataFrame", y =
 "RFspatialPointsDataFrame")</code></dt><dd>
<p>Similar to method for <code>y="missing"</code>, but additionally adds the
points of <code>y</code>. Requires 
<code>all.equal(x@.RFparams, y@.RFparams)</code>.</p>
</dd>
<dt><code>signature(x = "RFgridDataFrame", y = "missing")</code></dt><dd><p>Generates
plots of simulation results for space-time-dimension <i>=1</i>.
Handles different values for the number of repetitions as well as
multivariate responses.</p>
</dd>
<dt><code>signature(x = "RFpointsDataFrame", y = "missing")</code></dt><dd><p>Similar
to method for class <code><a href="RFgridDataFrame-class.html">RFgridDataFrame</a></code>, but for non-gridded data.</p>
</dd>
</dl>






































<h3>Author(s)</h3>

<p>Alexander Malinowski, Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>See Also</h3>

<p><code><a href="RFpar.html">RFpar</a></code>.
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

## define the model:
model &lt;- RMtrend(mean=0.5) + # mean
         RMstable(alpha=1, var=4, scale=10) + # see help("RMstable")
                                        ## for additional arguments
         RMnugget(var=1) # nugget


#############################################################
## Plot of covariance structure


plot(model)
plot(model, xlim=c(0, 30))
plot(model, xlim=c(0, 30), fct.type="Variogram")
plot(model, xlim=c(-10, 20), fct.type="Variogram", dim=2)
image(model, xlim=c(-10, 20), fct.type="Variogram")
persp(model, xlim=c(-10, 20), fct.type="Variogram")

#############################################################
## Plot of simulation results

## define the locations:
from &lt;- 0
step &lt;- .1 
len &lt;- 50  # nicer if len=100 %ok
 
x1D &lt;- GridTopology(from, step, len)
x2D &lt;- GridTopology(rep(from, 2), rep(step, 2), rep(len, 2))
x3D &lt;- GridTopology(rep(from, 3), rep(step, 3), rep(len, 3))

## 1-dimensional
sim1D &lt;- RFsimulate(model = model, x=x1D, n=6) 
plot(sim1D, nmax=4)

## 2-dimensional
sim2D &lt;- RFsimulate(model = model, x=x2D, n=6) 
plot(sim2D, nmax=4)
plot(sim2D, nmax=4, col=terrain.colors(64),
main="My simulation", xlab="my_xlab")

## 3-dimensional
model &lt;- RMmatern(nu=1.5, var=4, scale=2)
sim3D &lt;- RFsimulate(model = model, x=x3D) 
plot(sim3D, MARGIN=c(2,3), MARGIN.slices=1, n.slices=4)

 
#############################################################
## empirical variogram plots

x &lt;- seq(0, 10, 0.05)
bin &lt;- seq(from=0, by=.2, to=3)

model &lt;- RMexp()
X &lt;- RFsimulate(model, x=cbind(x))
ev1 &lt;- RFvariogram(data=X, bin=bin)
plot(ev1)

model &lt;- RMexp(Aniso = cbind(c(10,0), c(0,1)))
X &lt;- RFsimulate(model, x=cbind(x,x))
ev2 &lt;- RFvariogram(data=X, bin=bin, phi=3)
plot(ev2, model=list(exp = model))




#############################################################
## plot Kriging results 
model &lt;- RMwhittle(nu=1.2, scale=2)
n &lt;- 200
x &lt;- runif(n, max=step*len/2) 
y &lt;- runif(n, max=step*len/2) # 200 points in 2 dimensional space
sim &lt;- RFsimulate(model, x=x, y=y)

interpolate &lt;- RFinterpolate(model, x=x2D, data=sim)
plot(interpolate)
plot(interpolate, sim)


#############################################################
## plotting vector-valued results
model &lt;- RMdivfree(RMgauss(), scale=4)
x &lt;- y &lt;- seq(-10,10, 0.5)
simulated &lt;- RFsimulate(model, x=x, y=y, n=1)
plot(simulated)
plot(simulated, select.variables=list(1, 1:3, 4))



#############################################################
## options for the zlim argument
model &lt;- RMdelay(RMstable(alpha=1.9, scale=2), s=c(0, 4)) +
         RMdelay(RMstable(alpha=1.9, scale=2), s=c(4, 0))
simu &lt;- RFsimulate(model, x, y)

plot(simu, zlim=list(data=cbind(c(-6,2), c(-2,1)), var=c(5,6)))
plot(simu, zlim=cbind(c(-6,2), c(-2,1)))
plot(simu, zlim=c(-6,2))
plot(simu, zlim="joint")

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
