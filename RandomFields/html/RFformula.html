<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: RFformula - syntax to design random field models with trend...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RFformula {RandomFields}"><tr><td>RFformula {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>RFformula - syntax to design random field models with trend
or linear mixed models</h2>

<h3>Description</h3>

<p>It is described how to create a formula, which, for example, can be used as an argument of <code><a href="RFsimulate.html">RFsimulate</a></code> and
<code><a href="RFfit.html">RFfit</a></code> to simulate and to fit data according to the
model described by the formula.
</p>
<p>In general, the created formula serves two purposes:
</p>

<ul>
<li><p> to describe models in the &ldquo;Linear Mixed
Models&rdquo;-framework 
</p>
</li>
<li><p> to define models for random fields including trend surfaces from
a geostatistical point of view.
</p>
</li></ul>

<p>Thereby, fixed effects and trend surfaces can be adressed via
the expression <code><a href="RMfixed.html">RMfixed</a></code> and the function
<code><a href="RMtrend.html">RMtrend</a></code>. In simple cases, the trend can also
be given in a very simple, see the examples below.
The covariance structures of the zero-mean
multivariate normally distributed 
random field
components are adressed by objects of class <code><a href="RMmodel-class.html">RMmodel</a></code>, which
allow for a very flexible covariance specification.
</p>
<p>See <a href="RFformulaAdvanced.html">RFformulaAdvanced</a> for rather complicated model definitions.
</p>


<h3>Details</h3>

 
<p>The formula should be of the type
</p>
<p style="text-align: center;"><i>response ~ fixed effects %+ random effects
   + error term</i></p>

<p>or 
</p>
<p style="text-align: center;"><i>response ~ trend + zero-mean random field + nugget effect,</i></p>

<p>respectively.
</p>
<p>Thereby:
</p>

<ul>
<li><p> response<br />
optional; name of response variable
</p>
</li>
<li><p> fixed effects/trend:<br />
optional, should be a sum (using <code><a href="RMplus.html">+</a></code>)
of components either of the form <code>X@RMfixed(beta)</code> or
<code><a href="RMtrend.html">RMtrend</a>(...)</code> with <i>X</i> being a design matrix 
and <i>&beta;</i> being a vector of coefficients (see
<code><a href="RMfixed.html">RMfixed</a></code> and <code><a href="RMtrend.html">RMtrend</a></code>).<br />
Note that a fixed effect of the form <i>X</i> is interpreted as
<code>X@RMfixed(beta=NA)</code> by default (and <i>&beta;</i> is estimated
provided that the formula is used in <code><a href="RFfit.html">RFfit</a></code>).
</p>












</li>
<li><p> error term/nugget effect<br />
optional, should be of the form <code><a href="RMnugget.html">RMnugget</a>(...)</code>.
<code><a href="RMnugget.html">RMnugget</a></code> describes a vector
of iid Gaussian random variables.
</p>




</li></ul>



<h3>IMPORTANT</h3>

<p>Note that in formula constants are interpreted as part of a linear
model, i.e. the corresponding parameter has to be estimated
(e.g. <code>~ 1 + ...</code>) whereas in models not given as formula the
parameters to be estimated must be given explicitly.
</p>


<h3>Note</h3>

 
<p>(additional) argument names should always start with a capital
letter. Small initial letters are reserved  for <code><a href="RFoptions.html">RFoptions</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>References</h3>


<ul>
<li><p> Chiles, J.-P. and P. Delfiner (1999) <em>Geostatistics. Modeling
Spatial Uncertainty.</em> New York, Chichester: John Wiley &amp; Sons.
</p>
</li>
<li><p> McCulloch, C. E., Searle, S. R. and Neuhaus, J. M. (2008)
<em>Generalized, linear, and mixed models.</em> Hoboken, NJ: John
Wiley &amp; Sons.
</p>
</li>
<li><p> Ruppert, D. and Wand, M. P. and Carroll, R. J. (2003)
<em>Semiparametric regression.</em> Cambridge: Cambridge University
Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="RMmodel.html">RMmodel</a></code>,
<code><a href="RFsimulate.html">RFsimulate</a></code>,
<code><a href="RFfit.html">RFfit</a></code>,
<code><a href="RandomFields.html">RandomFields</a></code>.</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

RFoptions(modus_operandi="sloppy")

##############################################################
#
# Example  : Simulation and fitting of a two-dimensional
# Gaussian random field with exponential covariance function
#
###############################################################

V &lt;- 10
S &lt;- 0.3
M &lt;- 3
model &lt;- RMexp(var=V, scale=S) + M
x &lt;- y &lt;- seq(1, 3, 0.1)

simulated &lt;- RFsimulate(model = model, x=x, y=y)
plot(simulated)


# an alternative code to the above code:
model &lt;- ~ Mean + RMexp(var=Var, scale=Sc)
simulated2 &lt;- RFsimulate(model = model,x=x, y=y, Var=V, Sc=S, Mean=M)
plot(simulated2)


# a third way of specifying the model using the argument 'param'
# the initials of the variables do not be captical letters
model &lt;- ~ M + RMexp(var=var, scale=sc)
simulated3 &lt;- RFsimulate(model = model,x=x, y=y,
                         param=list(var=V, sc=S, M=M))
plot(simulated3)


# Estimate parameters of underlying covariance function via
# maximum likelihood
model.na &lt;- ~ NA + RMexp(var=NA, scale=NA)
fitted &lt;- RFfit(model=model.na, data=simulated)

# compare sample mean of data with ML estimate, which is very similar:
mean(simulated@data[,1]) 
fitted













</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
