<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Anisotropy matrix given by angle</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for RMangle {RandomFields}"><tr><td>RMangle {RandomFields}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Anisotropy matrix given by angle</h2>

<h3>Description</h3>

<p><code>RMangle</code> delivers an anisotropy matrix for the
argument <code>Aniso</code> in <code><a href="RMmodel.html">RMmodel</a></code> in two dimensions.
<code>RMangle</code> requires one or two stretching values, passed by
<code>ratio</code> or <code>diag</code>, and an <code>angle</code>.
</p>
<p>In two dimensions and with
<code>angle</code> equal to <i>a</i> and <code>diag</code> equal to <i>(d1, d2)</i> the
anisotropy matrix <i>A</i> is
</p>
<p><code>A = diag(d1, d2) %*% matrix(ncol=2, c(cos(a), sin(a), -sin(a), cos(a)))</code>
</p>
<p>In three dimensions and with
<code>angle</code> equal to <i>a</i>, second angle <i>L</i>
and <code>diag</code> equal to <i>(d1, d2, d3)</i> the
anisotropy matrix <i>A</i> is
</p>
<p><code>A = diag(d1, d2, d3) %*% matrix(ncol=3, c(cos(a) * cos(L), sin(a) * cos(L), sin(L), -sin(a), cos(a), 0, -cos(a) * sin(L), -sin(a) * sin(L), cos(L)
    ))</code>
i.e. <i>Ax</i> turns a vector x first in the <i>x-z</i> plane, then
in the <i>x-y</i> plane.
</p>


<h3>Usage</h3>

<pre>
RMangle(angle, lat.angle, ratio, diag) 
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>angle</code></td>
<td>
<p>angle <code>a</code></p>
</td></tr>
<tr valign="top"><td><code>lat.angle</code></td>
<td>
<p>second angle; in 3 dimensions only</p>
</td></tr>
<tr valign="top"><td><code>ratio</code></td>
<td>
<p>equivalent to <code>diag=c(1, 1/ratio)</code>; in 2 dimensions only</p>
</td></tr>
<tr valign="top"><td><code>diag</code></td>
<td>
<p>the diagonal components of the matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="RMangle.html">RMangle</a></code> returns an object of class <code><a href="RMmodel-class.html">RMmodel</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Schlather, <a href="mailto:schlather@math.uni-mannheim.de">schlather@math.uni-mannheim.de</a>, <a href="http://ms.math.uni-mannheim.de">http://ms.math.uni-mannheim.de</a></p>


<h3>See Also</h3>

<p><code><a href="RMtrafo.html">RMtrafo</a></code>, <code><a href="RMmodel.html">RMmodel</a></code>
</p>


<h3>Examples</h3>

<pre>
RFoptions(seed=0) ## *ANY* simulation will have the random seed 0; set
##                   RFoptions(seed=NA) to make them all random again

model &lt;- RMexp(Aniso=RMangle(angle=pi/4, ratio=3))
plot(model, dim=2)

x &lt;- seq(0, 2, 0.05)
z &lt;- RFsimulate(x, x, model=model)
plot(z)


model &lt;- RMexp(Aniso=RMangle(angle=pi/4, lat.angle=pi/8, diag=c(1,2,3)))
x &lt;- seq(0, 2, 0.2)
z &lt;- RFsimulate(x, x, x, model=model)
plot(z, MARGIN.slices=3)


## next model gives an example how to estimate the parameters back
n &lt;- 20
x &lt;- runif(n, 0, 10)
y &lt;- runif(n, 0, 10)
coords &lt;- expand.grid(x, y)
model &lt;- RMexp(Aniso=RMangle(angle=pi/4, diag=c(1/4, 1/12)))
d &lt;- RFsimulate(model, x=coords[, 1], y=coords[, 2], n=10)
estmodel &lt;- RMexp(Aniso=RMangle(angle=NA, diag=c(NA, NA)))
system.time(RFfit(estmodel, data=d, modus_operandi='sloppy'))

</pre>

<hr /><div style="text-align: center;">[Package <em>RandomFields</em> version 3.3.6 <a href="00Index.html">Index</a>]</div>
</body></html>
