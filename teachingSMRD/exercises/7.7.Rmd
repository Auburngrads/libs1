---
output: html_document
---

__A life test for a new insulating material used 50 specimens.  The specimens were tested simultaneously at 40kV (considerably higher than the rated voltage of 20kV).  The test was run until 10 of the specimens (this is known as "failure" or Type II censoring).  The failure times were recorded as 8, 11, 12, 13, 19, 21, 28, 34, 36, and 44 hours.  The engineers responsible for the reliability believe, based on previous experience with similar materials tested under similar conditions, that the failure-time distribution at 40kV can be described by an $EXP(\theta)$ distribution.__

a. __Construct an exponential probability plot of the data.  Does the plot provide any evidence that the exponential distribution is inadequate?__

`r teachingSMRD:::solution()$begin`
This problem involves Type II censoring, as the test was terminated after observing a specified number of failures (10).  The 40 specimens that did not fail should then be considered as right censored observations where $t_{11},...,t_{50}\in (44,\infty)$.

The simplest method for constructing this exponential probability plot is using the SMRD package.  This requires that we first put the event times and event designators in a data frame for the "frame.to.ld" function to use to create a life data object.  The following code can be used to
accomplish this.

```{r, echo=TRUE, fig.cap="Exponential probability plot for the insulating material accelerated life test data (40kV)"}
par(family = "serif")

obs7.7<-c(8,11,12,13,19,21,28,34,36,rep(44,41))
cen7.7<-c(rep("failed", 10), rep("censored", 40))
dat7.7<-data.frame(obs7.7, cen7.7)

insulate.ld<-frame.to.ld(dat7.7,
                         response.column = 1,
                         censor.column = 2,
                         time.units = "Hours")

plot(insulate.ld, 
     distribution = "Exponential", 
     plot.censored.ticks = "top")
```

This may also be found by inverting the cdf $F(\theta|t)=1-\text{exp}\left(-\frac{t}{\theta}\right)$ to obtain the exponential distribution quantile function $\text{log}\left(\frac{1}{1-p}\right)=\frac{t}{\theta}$. Since this data set is singly censored we replace the quantile value $p$ with the Hazen plotting position $\frac{i-0.5}{n}$ where $i$ denotes the ordered index of failure for each item under test and $n$ is the total sample size. These transformed quantile values are then plotted against the observation times on a standard axis plot.
`r teachingSMRD:::solution()$end`

b. __Compute TTT, the total time on test, and $\widehat{\theta},$ the ML estimate for $\theta$__

`r teachingSMRD:::solution()$begin`
The total time on test, $TTT$ can be calculated by summing the elements in the data vector defined above in part (a)

```{r,echo=TRUE,eval=FALSE}
obs7.7<-c(8,11,12,13,19,21,28,34,36,rep(44,41))
TTT<-sum(obs7.7)
```

Thus,

$$
TTT=\sum_{i=1}^{n}t_{_i}=1986.
$$

The ML estimate $\widehat{\theta}_MLE$ is computed by noting that the likelihood function for exponentially distributed data with exact failures and right censored observations may be expressed as

$$
L(\theta|\underline{X})=\prod_{i=1}^{n}\left(\frac{1}{\theta}\right)^{\delta_{i}}\exp\left(-\frac{t_{i}}{\theta}\right)
$$

The log-likelihood function is then

$$
\begin{aligned}
\mathcal{L}(\theta|\underline{X})&=\sum_{i=1}^{n}-\delta_{i}\log(\theta)-\left(\frac{t_{i}}{\theta}\right)\\\\
&=\sum_{i=1}^{n}-\delta_{i}\log(\theta)-\frac{\sum_{i=1}^{n}t_{i}}{\theta}
\end{aligned}
$$

Taking the derivative of $\mathcal{L}(\theta|\underline{X})$ with respect to $\theta$ and setting equal to 0 results in

$$
\widehat{\theta}_{_{MLE}}=\frac{\sum_{i=1}^{n}t_{i}}{\sum_{i=1}^{n}\delta_{i}}
$$

We note that the numerator in the above equation is the total time on test, $TTT$, while the denominator is the number of observed failures, thus 

$$
\widehat{\theta}_{_{MLE}}=\frac{1986\text{ hours}}{10\text{ failures}}=198.6.
$$
`r teachingSMRD:::solution()$end`

c. __Compute an estimate of the standard error of $\theta$__

`r teachingSMRD:::solution()$begin`
The standard error for $\widehat{\theta}$ may be found from

$$
\widehat{se}_{\widehat{\theta}}=\sqrt{\left[-\frac{d^{2}\mathcal{L}(\theta|\underline{X})}{d\theta^{2}}\right]^{-1}}.
$$

Returing to ($\eqref{eq:exploglike}$), the derivative of this function (the second derivative of the log-likelihood function) taken with respect to $\theta$ at the value $\widehat{\theta}_{_{MLE}}$ results in

$$
\begin{aligned}
\frac{d^{2}\mathcal{L}(\theta|\underline{X})}{d\theta^{2}}&=\frac{\sum_{i=1}^{n}\delta_{i}}{(\widehat{\theta}_{_{MLE}})^{2}}-\frac{2\sum_{i=1}^{n}t_{i}}{(\widehat{\theta}_{_{MLE}})^{3}}\\\\
&=\frac{r}{(\widehat{\theta}_{_{MLE}})^{2}}-\frac{2(TTT)}{\widehat{\theta}_{_{MLE}})^{3}}.
\end{aligned}
$$

Multiplying this function by $-1$, taking the reciprocal and simplifying results in

$$
\frac{d^{2}\mathcal{L}(\theta|\underline{X})}{d\theta^{2}}=\frac{(\widehat{\theta}_{_{MLE}})^2}{r}
$$

and

$$
\widehat{se}_{\widehat{\theta}_{_{MLE}}}=\frac{\widehat{\theta}_{_{MLE}}}{\sqrt{r}}=\frac{198.6}{\sqrt{10}}=62.8
$$
`r teachingSMRD:::solution()$end`

d. __Compute 95% confidence intervals for $\theta$ based on $Z_{\widehat{\theta}} \sim NOR(0,1), Z_{log(\widehat{\theta})} \sim NOR(0,1),$ and the exact distribution of $2(TTT/\theta).$ Which of these intervals would you feel comfortable using? Why?__

`r teachingSMRD:::solution()$begin`
The requested confidence intervals are shown below and may be computed using equations 7.10, 7.11 and the top equation on page 167, respectively.

$$
\begin{aligned}
CI(Z_{\widehat{\theta}})&=\widehat{\theta}\pm Z_{\left(1-\frac{\alpha}{2}\right)}\widehat{se}_{\widehat{\theta}}\hspace{46pt}=[75.51, 321.69]\\
CI\left(Z_{\log(\widehat{\theta})}\right)&=\widehat{\theta}\times \exp(\pm Z_{\left(1-\frac{\alpha}{2}\right)}\widehat{se}_{\widehat{\theta}}/{\widehat{\theta}})\hspace{5pt}=[106.86, 369.11]\\
CI(\text{Exact})&=\frac{2(TTT)}{\chi^{2}_{\left(1-\alpha/2;2r\right)}},\frac{2(TTT)}{\chi^{2}_{\left(\alpha/2;2r\right)}}\hspace{23pt}=[116.24, 414.15]
\end{aligned}
$$

Knowing that the exponential distribution is positively skewed, I would feel least comfortable using the $Z_{\widehat{\theta}}$ intervals.  I would feel most comfortable using the exact confidence interval. 
`r teachingSMRD:::solution()$end`

e. __For this problem, is there any extrapolation involved in estimating $\theta?$ Explain.__

`r teachingSMRD:::solution()$begin`
Extrapolation exists in assuming that the data follow an $\text{Exp}(\theta)$ distribution as this belief leads us to conclude that the ML estimate for $\theta=\frac{TTT}{r}$ 
`r teachingSMRD:::solution()$end`

f. __Compute 95% confidence intervals for $t_{.1}, h(50;\theta), and F(50;\theta)$ based on the exact distribution of $2(TTT/\theta).$  Is there any extrapolation involved in these intervals? Explain.__

`r teachingSMRD:::solution()$begin`
As discussed in class and in the text an exact $100(1-\alpha)\%$ confidence interval for $\theta$ may be expressed as

$$
\left[ \underline{\theta},\overline{\theta}\right]=\left[\frac{2(TTT)}{\chi^{2}_{(1-\alpha/2;2r)}},\frac{2(TTT)}{\chi^{2}_{(\alpha/2;2r)}}\right]
$$  

Since $t_{0.1}$ is a monotone function of $\theta$ where $t_{0.1}=-\theta\text{ log}(0.9)$ (via the exponential quantile function) it follows that an exact $95\%$ confidence interval for $t_{0.1}$ under Type II censoring can be expressed as

$$
\left[\frac{-2(TTT)\times\text{log}(0.9)}{\chi^{2}_{(0.975;18)}},\frac{-2(TTT)\times\text{log}(0.9)}{\chi^{2}_{(0.025;18)}}\right]=\left[12.25, 43.63\right]
$$

Similarly, the exponential hazard function $h(t)=\theta^{-1}$ is a monotone function of $\theta$ and an exact $95\%$ confidence interval for $h(t)$ under Type II censoring can be expressed as

$$
\left[\frac{\chi^{2}_{(0.025;18)}}{2(TTT)},\frac{\chi^{2}_{(0.975;18)}}{2(TTT)}\right]=\left[.00024, .00086\right]
$$

Finally, the exponential cdf $F(50|\theta)$ is also a monotone function of $\theta$.  Therefore, an exact $95\%$ confidence interval for $F(50|\theta)$ can be expressed as

$$
\left[1-\text{exp}\left(-50\frac{\chi^{2}_{(0.025;18)}}{2(TTT)}\right),1-\text{exp}\left(-50\frac{\chi^{2}_{(0.975;18)}}{2(TTT)}\right)\right]=\left[.114, .350\right]
$$
`r teachingSMRD:::solution()$end`
