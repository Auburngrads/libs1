---
output: html_document
---

__Refer to Exercise 17.3.  Suppose that log life can be described adequately by a normal distribution.  Consider the regression model $\mu=\beta_0+\beta_1\times\text{log}(stress)$ with constant $\sigma,$ where $\sigma$ is the standard deviation of log life, the same for any fixed level of stress.__

a. __Use ordinary least squares to fit this model to the rolling contact fatigue data.  Compare your answer to the graphical estimate from part (c) of Exercise 17.3.__

`r teachingSMRD:::solution()$begin`
In part (c) of Exercise 17.3 an ordinary least squares fit for the median failure times at each stress level was produced.  Here, we are asked to produced an OLS fit for the mean times to failure at each stress level, this plot may be produced using the following code.

```{r echo=TRUE,fig.cap="Results from McCool (1980) ceramic ball bearing rolling contact fatigue test"}
life17.3 <- 
  matrix(c(1.67,2.2,2.51,3,3.9,4.7,7.53,14.7,27.8,37.4,
           0.80,1,1.37,2.25,2.95,3.70,6.07,6.65,7.05,7.37,
            .012,.18,.2,.24,.26,.32,.32,.42,.44,.88,
            .073,.098,.117,.135,.175,.262,.270,.350,.386,.456),
            nrow = 4, byrow = TRUE)
stress17.3 <- 
  matrix(rep(c(.87,.99,1.09,1.18),each = 10),
         nrow = 4, byrow = TRUE)

plot(stress17.3,
     life17.3,
     axes = FALSE,
     xlab = expression("Contact Stress x "*10^-6*" psi"),
     ylab = expression("Revolutions x "*10^-6*""),
     log = "xy")
par(family="serif")
axis(side = 1, tck = -.015, labels = NA)
axis(side = 2, tck = -.015, labels = NA)
axis(side = 1, lwd = 0, line = -.6,at=(c(.87,.99,1.09,1.18)))
axis(side = 2, lwd = 0, line = -.6, las = 1)
points(x = stress17.3[,1],
       y = apply(life17.3,1,median),
       pch = 4,
       col = 2,
       cex = 2,
       lwd = 2)
abline(coef(lm(log(apply(life17.3,1,median))~log(stress17.3[,1]))),col=2)
abline(coef(lm(log(as.vector(stress17.3))~log(as.vector(life17.3)))), col = 12)
legend("bottomleft",
       c(expression("Median failure times"),
         expression("Mean failure times")),
       pch = 4,
       lwd = 1.5,
       col = c(2,12),
       cex = 1.25,
       bty = "n",
       xjust = 0.5)
```

The coefficients $\beta_{0} \text{ and } \beta_{1}$ for this model are

```{r echo=TRUE,eval=TRUE}
OLS <- lm(log(P17.3$y)~log(P17.3$x))

coef(OLS)
```

and the ordinary least squares estimate for ${\sigma}$ related to the mean squared error, where $(MSE)$ is found by taking the square root of the sum of the squared residuals, divided by the number of degrees of freedom for the model.  For this model,

$$
\widehat{\sigma}=\sqrt{MSE}=\sqrt{\frac{SSE}{n-2}}
$$

which can be computed in R using the following

```{r echo=TRUE,eval=TRUE}
sqrt(sum((OLS$res)^2)/OLS$df)
```
`r teachingSMRD:::solution()$end`

b. __Use a computer that does maximum likelihood estimation and fit the lognormal regression model (17.7) to the rolling contact fatigue data__

`r teachingSMRD:::solution()$begin`
The likelihood function for this set of $40$ exact failure observations is expressed as

$$
\mathcal{L}(\beta_{0},\beta_{1},\sigma|DATA)=\prod_{i=1}^{40}\frac{1}{t_{i}\sigma}\phi_{nor}\left(\frac{\text{log}(t_{i})-\beta_{0}+\beta_{1}\text{log}(stress)}{\sigma}\right)
$$

Computing the values for $(\beta_{0})_{_{MLE}},(\beta_{1})_{_{MLE}},\sigma_{_{MLE}}$ may be accomplished using the "survreg" function in the R package Survival.

```{r echo=TRUE,eval=TRUE}
library(survival)
survreg(Surv(P17.3$y,rep(1,40))~log(P17.3$x),dist="lognormal")
```
`r teachingSMRD:::solution()$end`

c. __Compute and compare estimates from these two different methods of estimation for the median time to failure at $1.05\times10^{6}$ psi, the $.01$ quantile at $1.05 \times 10^{6}$ psi and the $.01$ quantile at $0.85\times10^{6}$ psi.  Comment on the results of this comparison.__

`r teachingSMRD:::solution()$begin`
Comparing the coefficients $\beta_{0},\beta_{1}$ computed in part (a) with those computed here shows that they are equivalent.  This is expected as ordinary least squares and maximum likelihood estimation provide identical results for these values when the data are normally distributed with no censoring.  Note the small difference between the variance terms computed using the approaches

To compute the requested values, note that the quantile function for this regression model may be expressed as

$$
\text{log}(t_{i})=(\beta_{0})_{_{MLE}}+(\beta_{1})_{_{MLE}}\times\text{log}(stress)+\Phi^{-1}(p)\sigma_{_{MLE}}
$$

Using ordinary least squares resulted in the following values

$$
\begin{aligned}
t_{.50}(1.05\times10^{6})&=exp\left[.2703-12.573\times\text{log}(1.05)+\Phi_{nor}^{-1}(.50)(1.054)\right]=.709\times10^{6} \text{ Revolutions}\\
t_{.01}(1.05\times10^{6})&=exp\left[.2703-12.573\times\text{log}(1.05)+\Phi_{nor}^{-1}(.01)(1.054)\right]=.061\times10^{6} \text{ Revolutions}\\
t_{.01}(0.85\times10^{6})&=exp\left[.2703-12.573\times\text{log}(0.85)+\Phi_{nor}^{-1}(.01)(1.054)\right]=.872\times10^{6} \text{ Revolutions}
\end{aligned}
$$

while the values computed using maximum likelihood were found to be

$$
\begin{aligned}
t_{.50}(1.05\times10^{6})&=exp\left[.2703-12.573\times\text{log}(1.05)+\Phi_{nor}^{-1}(.50)(1.027)\right]=.709\times10^{6} \text{ Revolutions}\\
t_{.01}(1.05\times10^{6})&=exp\left[.2703-12.573\times\text{log}(1.05)+\Phi_{nor}^{-1}(.01)(1.027)\right]=.065\times10^{6} \text{ Revolutions}\\
t_{.01}(0.85\times10^{6})&=exp\left[.2703-12.573\times\text{log}(0.85)+\Phi_{nor}^{-1}(.01)(1.027)\right]=.927\times10^{6} \text{ Revolutions}
\end{aligned}
$$
`r teachingSMRD:::solution()$end`
