<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Banded jacobian matrix for a system of ODEs (ordinary...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for jacobian.band {rootSolve}"><tr><td>jacobian.band {rootSolve}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Banded jacobian matrix for a system of ODEs (ordinary differential equations)
</h2>

<h3>Description</h3>

<p>Given a vector of (state) variables <code>y</code>, and a function that estimates a
function value for each (state) variable (e.g. the rate of change),
estimates the Jacobian matrix (<i>d(f(y))/d(y)</i>).
</p>
<p>Assumes a banded structure of the Jacobian matrix, i.e. where the non-zero
elements are restricted to a number of bands above and below the diagonal.
</p>


<h3>Usage</h3>

<pre>
jacobian.band(y, func, bandup = 1, banddown = 1, 
              dy = NULL, time = 0, parms = NULL, pert = 1e-8, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>y </code></td>
<td>
<p>(state) variables, a vector; if <code>y</code> has a name attribute,
the names will be used to label the jacobian matrix columns.
</p>
</td></tr>
<tr valign="top"><td><code>func </code></td>
<td>
<p>function that calculates one function value for each element
of <code>y</code>; if an ODE system, <code>func</code> calculates the rate of change
(see details).
</p>
</td></tr>
<tr valign="top"><td><code>bandup </code></td>
<td>
<p>number of nonzero bands above the diagonal of the Jacobian
matrix.
</p>
</td></tr>
<tr valign="top"><td><code>banddown </code></td>
<td>
<p>number of nonzero bands below the diagonal of the Jacobian
matrix.
</p>
</td></tr>
<tr valign="top"><td><code>dy </code></td>
<td>
<p>reference function value; if not specified, it will be estimated
by calling <code>func</code>.
</p>
</td></tr>
<tr valign="top"><td><code>time </code></td>
<td>
<p>time, passed to function <code>func</code>.
</p>
</td></tr>
<tr valign="top"><td><code>parms </code></td>
<td>
<p>parameter values, passed to function <code>func</code>.
</p>
</td></tr>
<tr valign="top"><td><code>pert </code></td>
<td>
<p>numerical perturbation factor; increase depending on precision
of model solution.
</p>
</td></tr>
<tr valign="top"><td><code>... </code></td>
<td>
<p>other arguments passed to function <code>func</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>func</code> that estimates the rate of change of the state
variables has to be	consistent with functions called from R-package
<code>deSolve</code>, which contains integration routines.
</p>
<p>This function call is as: <b>function(time,y,parms,...)</b> where
</p>

<ul>
<li> <p><code>y</code> : (state) variable values at which the Jacobian is estimated.
</p>
</li>
<li> <p><code>parms</code>: parameter vector  - need not be used.
</p>
</li>
<li> <p><code>time</code>: time at which the Jacobian is estimated - in general,
<code>time</code> will not be used.
</p>
</li>
<li> <p><code>...</code>: (optional) any other arguments
</p>
</li></ul>

<p>The Jacobian is estimated numerically, by perturbing the x-values.
</p>


<h3>Value</h3>

<p>Jacobian matrix, in banded format, i.e. only the nonzero bands near the
diagonal form the rows of the Jacobian. 
</p>
<p>this matrix has <code>bandup</code>+<code>banddown</code>+1 rows, while the number of
columns equal the length of <code>y</code>.
</p>
<p>Thus, if the full Jacobian is given by:
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
         </td><td style="text-align: left;"> [,1],</td><td style="text-align: left;"> [,2],</td><td style="text-align: left;"> [,3],</td><td style="text-align: left;"> [,4] </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,1] </td><td style="text-align: left;"> 1    </td><td style="text-align: left;"> 2    </td><td style="text-align: left;"> 0    </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,2] </td><td style="text-align: left;"> 3    </td><td style="text-align: left;"> 4    </td><td style="text-align: left;"> 5    </td><td style="text-align: left;"> 0 </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,3] </td><td style="text-align: left;"> 0    </td><td style="text-align: left;"> 6    </td><td style="text-align: left;"> 7    </td><td style="text-align: left;"> 8 </td>
</tr>
<tr>
 <td style="text-align: left;">
    [,4] </td><td style="text-align: left;"> 0    </td><td style="text-align: left;"> 0    </td><td style="text-align: left;"> 9    </td><td style="text-align: left;"> 10
  </td>
</tr>

</table>

<p>the banded jacobian will be:
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: right;">
         </td><td style="text-align: left;"> [,1],</td><td style="text-align: left;"> [,2],</td><td style="text-align: left;"> [,3],</td><td style="text-align: left;"> [,4] </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,1] </td><td style="text-align: left;"> 0    </td><td style="text-align: left;"> 2    </td><td style="text-align: left;"> 5    </td><td style="text-align: left;"> 8 </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,2] </td><td style="text-align: left;"> 1    </td><td style="text-align: left;"> 4    </td><td style="text-align: left;"> 7    </td><td style="text-align: left;"> 10 </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,3] </td><td style="text-align: left;"> 3    </td><td style="text-align: left;"> 6    </td><td style="text-align: left;"> 9    </td><td style="text-align: left;"> 0
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><code><a href="jacobian.full.html">jacobian.full</a></code>, estimates the Jacobian matrix
assuming a full matrix.
</p>
<p><code><a href="hessian.html">hessian</a></code>, estimates the Hessian matrix.
</p>
<p><code><a href="gradient.html">gradient</a></code>, for a full (not necessarily square) gradient matrix
and where the function call is simpler.
</p>
<p><code><a href="uniroot.all.html">uniroot.all</a></code>, to solve for all roots of one (nonlinear) equation
</p>
<p><code><a href="multiroot.html">multiroot</a></code>, to solve n roots of n (nonlinear) equations
</p>


<h3>Examples</h3>

<pre>
## =======================================================================

mod &lt;- function (t = 0, y, parms = NULL,...) {
  dy1 &lt;-  y[1] + 2*y[2]
  dy2 &lt;-3*y[1] + 4*y[2] + 5*y[3]
  dy3 &lt;-         6*y[2] + 7*y[3] + 8*y[4]
  dy4 &lt;-                  9*y[3] +10*y[4]
  return(as.list(c(dy1, dy2, dy3, dy4)))
}

jacobian.band(y = c(1, 2, 3, 4), func = mod)
</pre>

<hr /><div style="text-align: center;">[Package <em>rootSolve</em> version 1.8.1 <a href="00Index.html">Index</a>]</div>
</body></html>
