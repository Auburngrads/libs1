<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Search algorithm in graphical models using marginal...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for bdgraph.mpl {BDgraph}"><tr><td>bdgraph.mpl {BDgraph}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>	Search algorithm in graphical models using marginal pseudo-likehlihood </h2>

<h3>Description</h3>

<p>This function consists of several sampling algorithms for Bayesian model determination in undirected graphical models based on mariginal pseudo-likelihood. 
To speed up the computations, the birth-death MCMC sampling algorithms are implemented in parallel using <span class="pkg">OpenMP</span> in <code>C++</code>.
</p>


<h3>Usage</h3>

<pre>
bdgraph.mpl( data, n = NULL, method = "ggm", transfer = TRUE, 
             algorithm = "bdmcmc", iter = 5000, burnin = iter / 2, 
             g.start = "empty", g.space = NULL, g.prior = 0.5, 
             multi.update = NULL, alpha = 0.5, save.all = FALSE, 
             print = 1000, cores = "all", operator = "or" )
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>

<p>There are two options: (1) an (<i>n \times p</i>) matrix or a <code>data.frame</code> corresponding to the data, 
(2) an (<i>p \times p</i>) covariance matrix as <i>S=X'X</i> which <i>X</i> is the data matrix 
(<i>n</i> is the sample size and <i>p</i> is the number of variables). 
It also could be an object of class <code>"sim"</code>, from function <code><a href="bdgraph.sim.html">bdgraph.sim</a></code>.
The input matrix is automatically identified by checking the symmetry.
</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>The number of observations. It is needed if the <code>"data"</code> is a covariance matrix.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>

<p>A character with two options <code>"ggm"</code> (default), <code>"dgm"</code> and <code>"dgm-binary"</code>. 
Option <code>"ggm"</code> is for Gaussian graphical models based on Gaussianity assumption.
Option <code>"dgm"</code> is for discrete graphical models for the data that are discrete.
Option <code>"dgm-binary"</code> is for discrete graphical models for the data that are binary.
</p>
</td></tr>
<tr valign="top"><td><code>transfer</code></td>
<td>
<p> For only discrete data which <code>method = "dgm"</code> or <code>method = "dgm-binary"</code>. </p>
</td></tr>
<tr valign="top"><td><code>algorithm</code></td>
<td>

<p>A character with two options <code>"bdmcmc"</code> (default) and <code>"rjmcmc"</code>. 
Option <code>"bdmcmc"</code> is based on birth-death MCMC algorithm.
Option <code>"rjmcmc"</code> is based on reverible jump MCMC algorithm.
</p>
</td></tr>
<tr valign="top"><td><code>iter</code></td>
<td>
<p>   The number of iteration for the sampling algorithm. </p>
</td></tr>
<tr valign="top"><td><code>burnin</code></td>
<td>
<p> The number of burn-in iteration for the sampling algorithm. </p>
</td></tr>
<tr valign="top"><td><code>g.start</code></td>
<td>

<p>Corresponds to a starting point of the graph. It could be <code>"empty"</code> (default) and <code>"full"</code>. 
Option <code>"empty"</code> means the initial graph is an empty graph and <code>"full"</code> means a full graph. 
It also could be an object with <code>S3</code> class <code>"bdgraph"</code>; 
with this option one could run the sampling algorithm from the last objects of previous run (see examples).     
</p>
</td></tr> 
<tr valign="top"><td><code>g.space</code></td>
<td>

<p>Corresponds to the sub-space of the graph. 
For the case <code> g.start = "NULL"</code> (default), algorithm search in the hole graph space. 
With this option, one could run the search algorithm only to the restricted subspace of the graph.
Subspace should determine as an adjacency matrix.
</p>
</td></tr> 
<tr valign="top"><td><code>g.prior</code></td>
<td>

<p>For determining the prior distribution of each edge in the graph. 
There are two options: a single value between <i>0</i> and <i>1</i> (e.g. <i>0.5</i> as a noninformative prior) 
or an (<i>p \times p</i>) matrix with elements between <i>0</i> and <i>1</i>.
</p>
</td></tr>
<tr valign="top"><td><code>multi.update</code></td>
<td>

<p>It is only for the BDMCMC algorithm (<code>algorithm = "bdmcmc"</code>).
It is for simultaneously updating multiple links at the same time to update graph in the BDMCMC algorithm.
</p>
</td></tr>	
<tr valign="top"><td><code>alpha</code></td>
<td>
<p> Value of the hyper parameter of Dirichlet, which is a prior distribution. </p>
</td></tr>
<tr valign="top"><td><code>save.all</code></td>
<td>

<p>Logical: if FALSE (default), the adjacency matrices are NOT saved. 
If TRUE, the adjacency matrices after burn-in are saved.
</p>
</td></tr>
<tr valign="top"><td><code>print</code></td>
<td>
<p> Value to see the number of iteration for the MCMC algorithm. </p>
</td></tr>
<tr valign="top"><td><code>cores</code></td>
<td>
<p> The number of cores to use for parallel execution. 
The default is to use <code>"all"</code> CPU cores of the computer; 
it can also be a number, e.g. <code>cores=2</code> means 2 CPU cores to use for parallel execution.
</p>
</td></tr>
<tr valign="top"><td><code>operator</code></td>
<td>
<p> A character with two options <code>"or"</code> (default) and <code>"and"</code>. It is for hill-climbing algorithm. </p>
</td></tr>	   	
</table>


<h3>Value</h3>

<p>An object with <code>S3</code> class <code>"bdgraph"</code> is returned:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>p_links</code></td>
<td>
<p> An upper triangular matrix which corresponds the estimated posterior probabilities of all possible links. </p>
</td></tr>
</table>
<p>For the case &quot;save.all = TRUE&quot; is returned:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>sample_graphs</code></td>
<td>
<p> A vector of strings which includes the adjacency matrices of visited graphs after burn-in.</p>
</td></tr>
<tr valign="top"><td><code>graph_weights</code></td>
<td>
<p> A vector which includes the waiting times of visited graphs after burn-in. </p>
</td></tr>
<tr valign="top"><td><code>all_graphs</code></td>
<td>
<p>A vector which includes the identity of the adjacency matrices for all iterations after burn-in. 
It is needed for monitoring the convergence of the BD-MCMC algorithm.</p>
</td></tr>
<tr valign="top"><td><code>all_weights</code></td>
<td>
<p>A vector which includes the waiting times for all iterations after burn-in. It is needed for monitoring the convergence of the BD-MCMC algorithm.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Reza Mohammadi and Adrian Dobra </p>


<h3>References</h3>

<p>Dobra, A. and R. Mohammadi (2017). Loglinear Model Selection and Human Mobility, <em>arXiv preprint arXiv:1711.02623</em>
</p>
<p>Mohammadi, A. and E. Wit (2015). Bayesian Structure Learning in Sparse Gaussian Graphical Models, <em>Bayesian Analysis</em>, 10(1):109-138
</p>
<p>Mohammadi, A. and A. Dobra (2017). The <code>R</code> Package <span class="pkg">BDgraph</span> for Bayesian Structure Learning in Graphical Models, <em>ISBA Bulletin</em>, 24(4):11-16
</p>
<p>Pensar, J. et al (2017) Marginal pseudo-likelihood learning of discrete Markov network structures, <em>Bayesian Analysis</em>
</p>
<p>Mohammadi, A. and E. Wit (2015). <span class="pkg">BDgraph</span>: An <code>R</code> Package for Bayesian Structure Learning in Graphical Models, <em>arXiv preprint arXiv:1501.05108</em> 
</p>


<h3>See Also</h3>

 <p><code><a href="bdgraph.html">bdgraph</a></code>, <code><a href="bdgraph.sim.html">bdgraph.sim</a></code>, <code><a href="summary.bdgraph.html">summary.bdgraph</a></code>, and <code><a href="compare.html">compare</a></code> </p>


<h3>Examples</h3>

<pre>
## Not run: 
# Generating multivariate normal data from a 'random' graph
data.sim &lt;- bdgraph.sim( n = 70, p = 6, size = 7, vis = TRUE )
   
bdgraph.obj &lt;- bdgraph.mpl( data = data.sim, iter = 10000 )
  
summary( bdgraph.obj )
   
# To compare our result with true graph
compare( data.sim, bdgraph.obj, colnames = c( "True graph", "BDgraph" ) )
   

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>BDgraph</em> version 2.49 <a href="00Index.html">Index</a>]</div>
</body></html>
