<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Sampling from G-Wishart distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rgwish {BDgraph}"><tr><td>rgwish {BDgraph}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Sampling from G-Wishart distribution</h2>

<h3>Description</h3>

<p>Generates random matrices, distributed according to the G-Wishart distribution with parameters b and D, <i>W_G(b, D)</i> with respect to the graph structure <i>G</i>. 
Note this fuction works for both non-decomposable and decomposable graphs. 
</p>


<h3>Usage</h3>

<pre> rgwish( n = 1, adj = NULL, b = 3, D = NULL, threshold = 1e-8 ) </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>n</code></td>
<td>
<p>The number of samples required. </p>
</td></tr>
<tr valign="top"><td><code>adj</code></td>
<td>

<p>The adjacency matrix corresponding to the graph structure which can be non-decomposable or decomposable. It should be an upper triangular matrix in which <i>a_{ij}=1</i> 
if there is a link between notes <i>i</i> and <i>j</i>, otherwise <i>a_{ij}=0</i>.
<code>adj</code> could be an object of class <code>"graph"</code>, from function <code><a href="graph.sim.html">graph.sim</a></code>.
It also could be an object of class <code>"sim"</code>, from function <code><a href="bdgraph.sim.html">bdgraph.sim</a></code>.
It also could be an object of class <code>"bdgraph"</code>, from functions <code><a href="bdgraph.mpl.html">bdgraph.mpl</a></code> or <code><a href="bdgraph.html">bdgraph</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>b</code></td>
<td>
<p>The degree of freedom for G-Wishart distribution, <i>W_G(b, D)</i>. </p>
</td></tr>
<tr valign="top"><td><code>D</code></td>
<td>
<p>The positive definite <i>(p \times p)</i> &quot;scale&quot; matrix for G-Wishart distribution, <i>W_G(b, D)</i>. 
The default is an identity matrix.</p>
</td></tr>
<tr valign="top"><td><code>threshold</code></td>
<td>
<p> The threshold value for the convergence of sampling algorithm from G-Wishart.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sampling from G-Wishart distribution, <i>K \sim W_G(b, D)</i>, with density:
</p>
<p style="text-align: center;"><i>Pr(K) \propto |K| ^ {(b - 2) / 2} \exp &le;ft\{- \frac{1}{2} \mbox{trace}(K \times D)\right\},</i></p>

<p>which <i>b &gt; 2</i> is the degree of freedom and D is a symmetric positive definite matrix.
</p>


<h3>Value</h3>

<p>A numeric array, say A, of dimension <i>(p \times p \times n)</i>, where each <i>A[,,i]</i> is a positive 
definite matrix, a realization of the G-Wishart distribution, <i>W_G(b, D)</i>.
Note, for the case <i>n=1</i>, the output is a matrix.
</p>


<h3>Author(s)</h3>

<p> Reza Mohammadi <a href="mailto:a.mohammadi@uva.nl">a.mohammadi@uva.nl</a> </p>


<h3>References</h3>

<p>Lenkoski, A. (2013). A direct sampler for G-Wishart variates, <em>Stat</em>, 2:119-128
</p>
<p>Mohammadi, R. and Wit, E. C. (2019). <span class="pkg">BDgraph</span>: An <code>R</code> Package for Bayesian Structure Learning in Graphical Models, <em>Journal of Statistical Software</em>, 89(3):1-30 
</p>
<p>Mohammadi, A. and Wit, E. C. (2015). Bayesian Structure Learning in Sparse Gaussian Graphical Models, <em>Bayesian Analysis</em>, 10(1):109-138
</p>
<p>Letac, G., Massam, H. and Mohammadi, R. (2018). The Ratio of Normalizing Constants for Bayesian Graphical Gaussian Model Selection, <em>arXiv preprint arXiv:1706.04416v2</em> 
</p>
<p>Mohammadi, A. et al (2017). Bayesian modelling of Dupuytren disease by using Gaussian copula graphical models, <em>Journal of the Royal Statistical Society: Series C</em>, 66(3):629-645 
</p>


<h3>See Also</h3>

 <p><code><a href="gnorm.html">gnorm</a></code>, <code><a href="rwish.html">rwish</a></code> </p>


<h3>Examples</h3>

<pre>
# Generating a 'circle' graph as a non-decomposable graph
adj &lt;- graph.sim( p = 5, graph = "circle" )
adj    # adjacency of graph with 5 nodes
  
sample &lt;- rgwish( n = 1, adj = adj, b = 3, D = diag( 5 ) )
round( sample, 2 ) 

sample &lt;- rgwish( n = 5, adj = adj )
round( sample, 2 )  
</pre>

<hr /><div style="text-align: center;">[Package <em>BDgraph</em> version 2.62 <a href="00Index.html">Index</a>]</div>
</body></html>
