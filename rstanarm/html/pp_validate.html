<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Model validation via simulation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for pp_validate {rstanarm}"><tr><td>pp_validate {rstanarm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Model validation via simulation</h2>

<h3>Description</h3>

<p>The <code>pp_validate</code> function is based on the methods described in
Cook, Gelman, and Rubin (2006) for validating software developed to fit
particular Bayesian models. Here we take the perspective that models
themselves are software and thus it is useful to apply this validation
approach to individual models.
</p>


<h3>Usage</h3>

<pre>
pp_validate(object, nreps = 20, seed = 12345, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>A fitted model object returned by one of the 
<span class="pkg">rstanarm</span> modeling functions. See <code><a href="stanreg-objects.html">stanreg-objects</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>nreps</code></td>
<td>
<p>The number of replications to be performed. <code>nreps</code> must be
sufficiently large so that the statistics described below in Details are
meaningful. Depending on the model and the size of the data, running
<code>pp_validate</code> may be slow. See also the Note section below for advice
on avoiding numerical issues.</p>
</td></tr>
<tr valign="top"><td><code>seed</code></td>
<td>
<p>A seed passed to Stan to use when refitting the model.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We repeat <code>nreps</code> times the process of simulating parameters and data
from the model and refitting the model to this simulated data. For each of
the <code>nreps</code> replications we do the following:
</p>

<ol>
<li><p> Refit the model but <em>without</em> conditioning on the data (setting
<code>prior_PD=TRUE</code>), obtaining draws <i>&theta;_true</i>
from the <em>prior</em> distribution of the model parameters.
</p>
</li>
<li><p> Given <i>&theta;_true</i>, simulate data <i>y*</i>
from the <em>prior</em> predictive distribution (calling
<code><a href="posterior_predict.stanreg.html">posterior_predict</a></code> on the fitted model object obtained in step
1).
</p>
</li>
<li><p> Fit the model to the simulated outcome <i>y*</i>, obtaining
parameters <i>&theta;_post</i>.
</p>
</li></ol>

<p>For any individual parameter, the quantile of the &quot;true&quot; parameter value with
respect to its posterior distribution <em>should</em> be uniformly distributed.
The validation procedure entails looking for deviations from uniformity by
computing statistics for a test that the quantiles are uniformly distributed.
The absolute values of the computed  test statistics are plotted for batches
of parameters (e.g., non-varying coefficients are grouped into a batch called
&quot;beta&quot;, parameters that vary by group level are in batches named for the
grouping variable, etc.). See Cook, Gelman, and Rubin (2006) for more details
on the validation procedure.
</p>


<h3>Value</h3>

<p>A ggplot object that can be further customized using the
<span class="pkg">ggplot2</span> package.
</p>


<h3>Note</h3>

<p>In order to make it through <code>nreps</code> replications without running
into numerical difficulties you may have to restrict the range for randomly
generating initial values for parameters when you fit the <em>original</em>
model. With any of <span class="pkg">rstanarm</span>'s modeling functions this can be done by
specifying the optional argument <code>init_r</code> as some number less than the
default of <i>2</i>.
</p>


<h3>References</h3>

<p>Cook, S., Gelman, A., and Rubin, D.
(2006). Validation of software for Bayesian models using posterior quantiles.
<em>Journal of Computational and Graphical Statistics</em>. 15(3), 675&ndash;692.
</p>


<h3>See Also</h3>

<p><code><a href="pp_check.stanreg.html">pp_check</a></code> for graphical posterior predictive checks and
<code><a href="posterior_predict.stanreg.html">posterior_predict</a></code> to draw from the posterior predictive
distribution.
</p>
<p><code><a href="../../bayesplot/html/color_scheme_set.html">color_scheme_set</a></code> to change the color scheme of the
plot.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
if (!exists("example_model")) example(example_model)
try(pp_validate(example_model)) # fails with default seed / priors

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>rstanarm</em> version 2.17.2 <a href="00Index.html">Index</a>]</div>
</body></html>
