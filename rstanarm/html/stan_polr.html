<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Bayesian ordinal regression models via Stan</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for stan_polr {rstanarm}"><tr><td>stan_polr {rstanarm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Bayesian ordinal regression models via Stan</h2>

<h3>Description</h3>

<p>Bayesian inference for ordinal (or binary) regression models under
a proportional odds assumption.
</p>


<h3>Usage</h3>

<pre>
stan_polr(formula, data, weights, ..., subset,
  na.action = getOption("na.action", "na.omit"), contrasts = NULL,
  model = TRUE, method = c("logistic", "probit", "loglog", "cloglog",
  "cauchit"), prior = R2(stop("'location' must be specified")),
  prior_counts = dirichlet(1), shape = NULL, rate = NULL,
  prior_PD = FALSE, algorithm = c("sampling", "meanfield", "fullrank"),
  adapt_delta = NULL, do_residuals = NULL)

stan_polr.fit(x, y, wt = NULL, offset = NULL, method = c("logistic",
  "probit", "loglog", "cloglog", "cauchit"), ...,
  prior = R2(stop("'location' must be specified")),
  prior_counts = dirichlet(1), shape = NULL, rate = NULL,
  prior_PD = FALSE, algorithm = c("sampling", "meanfield", "fullrank"),
  adapt_delta = NULL, do_residuals = algorithm == "sampling")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula, data, subset</code></td>
<td>
<p>Same as <code><a href="../../MASS/html/polr.html">polr</a></code>, 
but <em>we strongly advise against omitting the <code>data</code>
argument</em>. Unless <code>data</code> is specified (and is a data frame) many
post-estimation functions (including <code>update</code>, <code>loo</code>,
<code>kfold</code>) are not guaranteed to work properly.</p>
</td></tr>
<tr valign="top"><td><code>weights, na.action, contrasts, model</code></td>
<td>
<p>Same as <code><a href="../../MASS/html/polr.html">polr</a></code>, but
rarely specified.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further arguments passed to the function in the <span class="pkg">rstan</span> 
package (<code><a href="../../rstan/html/sampling.html">sampling</a></code>, <code><a href="../../rstan/html/vb.html">vb</a></code>, or 
<code><a href="../../rstan/html/optimizing.html">optimizing</a></code>), corresponding to the estimation method 
named by <code>algorithm</code>. For example, if <code>algorithm</code> is
<code>"sampling"</code> it is possibly to specify <code>iter</code>, <code>chains</code>,
<code>cores</code>, <code>refresh</code>, etc.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>One of 'logistic', 'probit', 'loglog', 'cloglog' or 'cauchit',
but can be abbreviated. See <code><a href="../../MASS/html/polr.html">polr</a></code> for more details.</p>
</td></tr>
<tr valign="top"><td><code>prior</code></td>
<td>
<p>Prior for coefficients. Should be a call to <code><a href="priors.html">R2</a></code>
to specify the prior location of the <i>R^2</i> but can be <code>NULL</code>
to indicate a standard uniform prior. See <code><a href="priors.html">priors</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>prior_counts</code></td>
<td>
<p>A call to <code><a href="priors.html">dirichlet</a></code> to specify the
prior counts of the outcome when the predictors are at their sample
means.</p>
</td></tr>
<tr valign="top"><td><code>shape</code></td>
<td>
<p>Either <code>NULL</code> or a positive scalar that is interpreted
as the shape parameter for a <code><a href="../../stats/html/GammaDist.html">GammaDist</a></code>ribution on
the exponent applied to the probability of success when there are only
two outcome categories. If <code>NULL</code>, which is the default, then the
exponent is taken to be fixed at <i>1</i>.</p>
</td></tr>
<tr valign="top"><td><code>rate</code></td>
<td>
<p>Either <code>NULL</code> or a positive scalar that is interpreted
as the rate parameter for a <code><a href="../../stats/html/GammaDist.html">GammaDist</a></code>ribution on
the exponent applied to the probability of success when there are only
two outcome categories. If <code>NULL</code>, which is the default, then the
exponent is taken to be fixed at <i>1</i>.</p>
</td></tr>
<tr valign="top"><td><code>prior_PD</code></td>
<td>
<p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to draw from the prior predictive distribution instead of
conditioning on the outcome.</p>
</td></tr>
<tr valign="top"><td><code>algorithm</code></td>
<td>
<p>A string (possibly abbreviated) indicating the 
estimation approach to use. Can be <code>"sampling"</code> for MCMC (the
default), <code>"optimizing"</code> for optimization, <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution. See <code><a href="rstanarm-package.html">rstanarm-package</a></code> for more details on the
estimation algorithms. NOTE: not all fitting functions support all four
algorithms.</p>
</td></tr>
<tr valign="top"><td><code>adapt_delta</code></td>
<td>
<p>Only relevant if <code>algorithm="sampling"</code>. See 
<code><a href="adapt_delta.html">adapt_delta</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>do_residuals</code></td>
<td>
<p>A logical scalar indicating whether or not to 
automatically calculate fit residuals after sampling completes. Defaults to
<code>TRUE</code> if and only if <code>algorithm="sampling"</code>. Setting
<code>do_residuals=FALSE</code> is only useful in the somewhat rare case that
<code>stan_polr</code> appears to finish sampling but hangs instead of returning
the fitted model object.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>A design matrix.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>A response variable, which must be a (preferably ordered) factor.</p>
</td></tr>
<tr valign="top"><td><code>wt</code></td>
<td>
<p>A numeric vector (possibly <code>NULL</code>) of observation weights.</p>
</td></tr>
<tr valign="top"><td><code>offset</code></td>
<td>
<p>A numeric vector (possibly <code>NULL</code>) of offsets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>stan_polr</code> function is similar in syntax to
<code><a href="../../MASS/html/polr.html">polr</a></code> but rather than performing maximum likelihood
estimation of a proportional odds model, Bayesian estimation is performed
(if <code>algorithm = "sampling"</code>) via MCMC. The <code>stan_polr</code>
function calls the workhorse <code>stan_polr.fit</code> function, but it is
possible to call the latter directly.
</p>
<p>As for <code><a href="stan_lm.html">stan_lm</a></code>, it is necessary to specify the prior
location of <i>R^2</i>. In this case, the <i>R^2</i> pertains to the
proportion of variance in the latent variable (which is discretized
by the cutpoints) attributable to the predictors in the model.
</p>
<p>Prior beliefs about the cutpoints are governed by prior beliefs about the
outcome when the predictors are at their sample means. Both of these
are explained in the help page on <code><a href="priors.html">priors</a></code> and in the
<span class="pkg">rstanarm</span> vignettes.
</p>
<p>Unlike <code><a href="../../MASS/html/polr.html">polr</a></code>, <code>stan_polr</code> also allows the &quot;ordinal&quot;
outcome to contain only two levels, in which case the likelihood is the
same by default as for <code><a href="stan_glm.html">stan_glm</a></code> with <code>family = binomial</code>
but the prior on the coefficients is different. However, <code>stan_polr</code>
allows the user to specify the <code>shape</code> and <code>rate</code> hyperparameters,
in which case the probability of success is defined as the logistic CDF of
the linear predictor, raised to the power of <code>alpha</code> where <code>alpha</code>
has a gamma prior with the specified <code>shape</code> and <code>rate</code>. This
likelihood is called &ldquo;scobit&rdquo; by Nagler (1994) because if <code>alpha</code>
is not equal to <i>1</i>, then the relationship between the linear predictor
and the probability of success is skewed. If <code>shape</code> or <code>rate</code> is
<code>NULL</code>, then <code>alpha</code> is assumed to be fixed to <i>1</i>.
</p>
<p>Otherwise, it is usually advisible to set <code>shape</code> and <code>rate</code> to
the same number so that the expected value of <code>alpha</code> is <i>1</i> while
leaving open the possibility that <code>alpha</code> may depart from <i>1</i> a
little bit. It is often necessary to have a lot of data in order to estimate
<code>alpha</code> with much precision and always necessary to inspect the
Pareto shape parameters calculated by <code><a href="loo.stanreg.html">loo</a></code> to see if the
results are particularly sensitive to individual observations.
</p>
<p>Users should think carefully about how the outcome is coded when using
a scobit-type model. When <code>alpha</code> is not <i>1</i>, the asymmetry
implies that the probability of success is most sensitive to the predictors
when the probability of success is less than <i>0.63</i>. Reversing the
coding of the successes and failures allows the predictors to have the
greatest impact when the probability of failure is less than <i>0.63</i>.
Also, the gamma prior on <code>alpha</code> is positively skewed, but you
can reverse the coding of the successes and failures to circumvent this
property.
</p>


<h3>Value</h3>

<p>A <a href="stanreg-objects.html">stanreg</a> object is returned 
for <code>stan_polr</code>.
</p>
<p>A <a href="../../rstan/html/stanfit-class.html">stanfit</a> object (or a slightly modified 
stanfit object) is returned if <code>stan_polr.fit</code> is called directly.
</p>


<h3>References</h3>

<p>Nagler, J., (1994). Scobit: An Alternative Estimator to Logit and Probit.
<em>American Journal of Political Science</em>. 230 &ndash; 255.
</p>


<h3>See Also</h3>

<p><code><a href="stanreg-methods.html">stanreg-methods</a></code> and 
<code><a href="../../MASS/html/polr.html">polr</a></code>.
</p>
<p>The vignette for <code>stan_polr</code>.
</p>


<h3>Examples</h3>

<pre>
if (!grepl("^sparc",  R.version$platform)) {
 fit &lt;- stan_polr(tobgp ~ agegp, data = esoph, method = "probit",
          prior = R2(0.2, "mean"), init_r = 0.1, seed = 12345,
          algorithm = "fullrank") # for speed only
 print(fit)
 plot(fit)
}

</pre>

<hr /><div style="text-align: center;">[Package <em>rstanarm</em> version 2.17.2 <a href="00Index.html">Index</a>]</div>
</body></html>
