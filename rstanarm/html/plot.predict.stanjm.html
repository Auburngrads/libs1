<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot the estimated subject-specific or marginal longitudinal...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plot.predict.stanjm {rstanarm}"><tr><td>plot.predict.stanjm {rstanarm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot the estimated subject-specific or marginal longitudinal trajectory</h2>

<h3>Description</h3>

<p>This generic <code>plot</code> method for <code>predict.stanjm</code> objects will
plot the estimated subject-specific or marginal longitudinal trajectory
using the data frame returned by a call to <code><a href="posterior_traj.html">posterior_traj</a></code>.
To ensure that enough data points are available to plot the longitudinal
trajectory, it is assumed that the call to <code><a href="posterior_traj.html">posterior_traj</a></code>
would have used the default <code>interpolate = TRUE</code>, and perhaps also 
<code>extrapolate = TRUE</code> (the latter being optional, depending on 
whether or not the user wants to see extrapolation of the longitudinal 
trajectory beyond the last observation time).
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'predict.stanjm'
plot(x, ids = NULL, limits = c("ci", "pi", "none"),
  xlab = NULL, ylab = NULL, vline = FALSE, plot_observed = FALSE,
  facet_scales = "free_x", ci_geom_args = NULL, grp_overlay = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A data frame and object of class <code>predict.stanjm</code>
returned by a call to the function <code><a href="posterior_traj.html">posterior_traj</a></code>.
The object contains point estimates and uncertainty interval limits
for the fitted values of the longitudinal response.</p>
</td></tr>
<tr valign="top"><td><code>ids</code></td>
<td>
<p>An optional vector providing a subset of subject IDs for whom 
the predicted curves should be plotted.</p>
</td></tr>
<tr valign="top"><td><code>limits</code></td>
<td>
<p>A quoted character string specifying the type of limits to
include in the plot. Can be one of: <code>"ci"</code> for the Bayesian
posterior uncertainty interval for the estimated mean longitudinal
response (often known as a credible interval);
<code>"pi"</code> for the prediction interval for the estimated (raw)
longitudinal response; or <code>"none"</code> for no interval limits.</p>
</td></tr>
<tr valign="top"><td><code>xlab, ylab</code></td>
<td>
<p>An optional axis label passed to 
<code><a href="../../ggplot2/html/labs.html">labs</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>vline</code></td>
<td>
<p>A logical. If <code>TRUE</code> then a vertical dashed line
is added to the plot indicating the event or censoring time for
the individual. Can only be used if each plot within the figure
is for a single individual.</p>
</td></tr>
<tr valign="top"><td><code>plot_observed</code></td>
<td>
<p>A logical. If <code>TRUE</code> then the observed
longitudinal measurements are overlaid on the plot.</p>
</td></tr>
<tr valign="top"><td><code>facet_scales</code></td>
<td>
<p>A character string passed to the <code>scales</code>
argument of <code><a href="../../ggplot2/html/facet_wrap.html">facet_wrap</a></code> when plotting the 
longitudinal trajectory for more than one individual.</p>
</td></tr>
<tr valign="top"><td><code>ci_geom_args</code></td>
<td>
<p>Optional arguments passed to 
<code><a href="../../ggplot2/html/geom_ribbon.html">geom_ribbon</a></code> and used to control features
of the plotted interval limits. They should be supplied as a named list.</p>
</td></tr>
<tr valign="top"><td><code>grp_overlay</code></td>
<td>
<p>Only relevant if the model had lower level units 
clustered within an individual. If <code>TRUE</code>, then the fitted trajectories 
for the lower level units will be overlaid in the same plot region (that 
is, all lower level units for a single individual will be shown within a 
single facet). If <code>FALSE</code>, then the fitted trajectories for each lower
level unit will be shown in a separate facet.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Optional arguments passed to 
<code><a href="../../ggplot2/html/geom_smooth.html">geom_smooth</a></code> and used to control features
of the plotted longitudinal trajectory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object, also of class <code>plot.predict.stanjm</code>.
This object can be further customised using the <span class="pkg">ggplot2</span> package.
It can also be passed to the function <code><a href="plot.survfit.stanjm.html">plot_stack_jm</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="posterior_traj.html">posterior_traj</a></code>, <code><a href="plot.survfit.stanjm.html">plot_stack_jm</a></code>,
<code><a href="posterior_survfit.html">posterior_survfit</a></code>, <code><a href="plot.survfit.stanjm.html">plot.survfit.stanjm</a></code>
</p>


<h3>Examples</h3>

<pre>

  # Run example model if not already loaded
  if (!exists("example_jm")) example(example_jm)
  
  # For a subset of individuals in the estimation dataset we will
  # obtain subject-specific predictions for the longitudinal submodel 
  # at evenly spaced times between 0 and their event or censoring time.
  pt1 &lt;- posterior_traj(example_jm, ids = c(7,13,15), interpolate = TRUE)
  plot(pt1)                  # credible interval for mean response
  plot(pt1, limits = "pi")   # prediction interval for raw response
  plot(pt1, limits = "none") # no uncertainty interval
  
  # We can also extrapolate the longitudinal trajectories.
  pt2 &lt;- posterior_traj(example_jm, ids = c(7,13,15), interpolate = TRUE,
                        extrapolate = TRUE)
  plot(pt2)
  plot(pt2, vline = TRUE)    # add line indicating event or censoring time
  plot(pt2, vline = TRUE, plot_observed = TRUE)  # overlay observed longitudinal data
 
  # We can change or add attributes to the plot
  plot1 &lt;- plot(pt2, ids = c(7,13,15), xlab = "Follow up time",
                     vline = TRUE, plot_observed = TRUE, 
                     facet_scales = "fixed", color = "blue", linetype = 2,
                     ci_geom_args = list(fill = "red"))
  plot1
       
  # Since the returned plot is also a ggplot object, we can
  # modify some of its attributes after it has been returned
  plot1 + 
    ggplot2::theme(strip.background = ggplot2::element_blank()) +
    ggplot2::labs(title = "Some plotted longitudinal trajectories")

</pre>

<hr /><div style="text-align: center;">[Package <em>rstanarm</em> version 2.17.2 <a href="00Index.html">Index</a>]</div>
</body></html>
