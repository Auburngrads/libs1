<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Compute weighted expectations using LOO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for loo_predict.stanreg {rstanarm}"><tr><td>loo_predict.stanreg {rstanarm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Compute weighted expectations using LOO</h2>

<h3>Description</h3>

<p>These functions are wrappers around the <code><a href="../../loo/html/E_loo.html">E_loo</a></code> function 
(<span class="pkg">loo</span> package).
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'stanreg'
loo_predict(object, type = c("mean", "var", "quantile"),
  probs = 0.5, ..., lw)

## S3 method for class 'stanreg'
loo_linpred(object, type = c("mean", "var", "quantile"),
  probs = 0.5, transform = FALSE, ..., lw)

## S3 method for class 'stanreg'
loo_predictive_interval(object, prob = 0.9, ..., lw)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>A fitted model object returned by one of the 
<span class="pkg">rstanarm</span> modeling functions. See <code><a href="stanreg-objects.html">stanreg-objects</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>The type of expectation to compute. The options are
<code>"mean"</code>, <code>"var"</code> (variance), and <code>"quantile"</code>.</p>
</td></tr>
<tr valign="top"><td><code>probs</code></td>
<td>
<p>A vector of probabilities. Ignored unless <code>type</code> is
<code>"quantile"</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Optional arguments passed to <code><a href="../../loo/html/psislw.html">psislw</a></code>. If 
<code>lw</code> is specified these arguments are ignored.</p>
</td></tr>
<tr valign="top"><td><code>lw</code></td>
<td>
<p>An optional matrix of (smoothed) log-weights. If <code>lw</code> is 
missing then <code><a href="../../loo/html/psislw.html">psislw</a></code> is executed internally, which may be
time consuming for models fit to very large datasets.</p>
</td></tr>
<tr valign="top"><td><code>transform</code></td>
<td>
<p>Passed to <code><a href="posterior_linpred.stanreg.html">posterior_linpred</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>
<p>For <code>loo_predictive_interval</code>, a scalar in <i>(0,1)</i>
indicating the desired probability mass to include in the intervals. The
default is <code>prob=0.9</code> (<i>90</i>% intervals).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>loo_predict</code> and <code>loo_linpred</code> return a vector with one 
element per observation. The only exception is if <code>type="quantile"</code> 
and <code>length(probs) &gt;= 2</code>, in which case a separate vector for each 
element of <code>probs</code> is computed and they are returned in a matrix with 
<code>length(probs)</code> rows and one column per observation.
</p>
<p><code>loo_predictive_interval</code> returns a matrix with one row per 
observation and two columns (like <code><a href="predictive_interval.stanreg.html">predictive_interval</a></code>). 
<code>loo_predictive_interval(..., prob = p)</code> is equivalent to 
<code>loo_predict(..., type = "quantile", probs = c(a, 1-a))</code> with 
<code>a = (1 - p)/2</code>, except it transposes the result and adds informative 
column names.
</p>


<h3>References</h3>

<p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical
Bayesian model evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing</em>. 27(5), 1413&ndash;1432.
doi:10.1007/s11222-016-9696-4. arXiv preprint:
<a href="http://arxiv.org/abs/1507.04544/">http://arxiv.org/abs/1507.04544/</a>
</p>


<h3>Examples</h3>

<pre>
## Not run: 
if (!exists("example_model")) example(example_model)
head(loo_predictive_interval(example_model, prob = 0.8, cores = 2))

# optionally, log-weights can be pre-computed and reused
psis &lt;- loo::psislw(-log_lik(example_model), cores = 2)
loo_predictive_interval(example_model, prob = 0.8, lw = psis$lw_smooth)
loo_predict(example_model, type = "var", lw = psis$lw_smooth)

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>rstanarm</em> version 2.17.2 <a href="00Index.html">Index</a>]</div>
</body></html>
