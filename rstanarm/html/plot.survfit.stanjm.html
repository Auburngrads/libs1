<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot the estimated subject-specific or marginal survival...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plot.survfit.stanjm {rstanarm}"><tr><td>plot.survfit.stanjm {rstanarm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot the estimated subject-specific or marginal survival function</h2>

<h3>Description</h3>

<p>This generic <code>plot</code> method for <code>survfit.stanjm</code> objects will
plot the estimated subject-specific or marginal survival function
using the data frame returned by a call to <code><a href="posterior_survfit.html">posterior_survfit</a></code>.
The call to <code>posterior_survfit</code> should ideally have included an
&quot;extrapolation&quot; of the survival function, obtained by setting the 
<code>extrapolate</code> argument to <code>TRUE</code>.
</p>
<p>The <code>plot_stack_jm</code> function takes arguments containing the plots of the estimated  
subject-specific longitudinal trajectory (or trajectories if a multivariate  
joint model was estimated) and the plot of the estimated subject-specific 
survival function and combines them into a single figure. This is most
easily understood by running the <strong>Examples</strong> below.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'survfit.stanjm'
plot(x, ids = NULL, limits = c("ci", "none"),
  xlab = NULL, ylab = NULL, facet_scales = "free", ci_geom_args = NULL,
  ...)

plot_stack_jm(yplot, survplot)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A data frame and object of class <code>survfit.stanjm</code>
returned by a call to the function <code><a href="posterior_survfit.html">posterior_survfit</a></code>.
The object contains point estimates and uncertainty interval limits
for estimated values of the survival function.</p>
</td></tr>
<tr valign="top"><td><code>ids</code></td>
<td>
<p>An optional vector providing a subset of subject IDs for whom 
the predicted curves should be plotted.</p>
</td></tr>
<tr valign="top"><td><code>limits</code></td>
<td>
<p>A quoted character string specifying the type of limits to
include in the plot. Can be one of: <code>"ci"</code> for the Bayesian
posterior uncertainty interval for the estimated survival probability
(often known as a credible interval); or <code>"none"</code> for no interval 
limits.</p>
</td></tr>
<tr valign="top"><td><code>xlab, ylab</code></td>
<td>
<p>An optional axis label passed to 
<code><a href="../../ggplot2/html/labs.html">labs</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>facet_scales</code></td>
<td>
<p>A character string passed to the <code>scales</code>
argument of <code><a href="../../ggplot2/html/facet_wrap.html">facet_wrap</a></code> when plotting the 
longitudinal trajectory for more than one individual.</p>
</td></tr>
<tr valign="top"><td><code>ci_geom_args</code></td>
<td>
<p>Optional arguments passed to 
<code><a href="../../ggplot2/html/geom_ribbon.html">geom_ribbon</a></code> and used to control features
of the plotted interval limits. They should be supplied as a named list.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Optional arguments passed to 
<code><a href="../../ggplot2/html/geom_line.html">geom_line</a></code> and used to control features
of the plotted survival function.</p>
</td></tr>
<tr valign="top"><td><code>yplot</code></td>
<td>
<p>An object of class <code>plot.predict.stanjm</code>, returned by a 
call to the generic <code><a href="plot.predict.stanjm.html">plot</a></code> method for 
objects of class <code>predict.stanjm</code>. If there is more than one 
longitudinal outcome, then a list of such objects can be provided.</p>
</td></tr>
<tr valign="top"><td><code>survplot</code></td>
<td>
<p>An object of class <code>plot.survfit.stanjm</code>, returned by a 
call to the generic <code><a href="plot.survfit.stanjm.html">plot</a></code> method for 
objects of class <code>survfit.stanjm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The plot method returns a <code>ggplot</code> object, also of class
<code>plot.survfit.stanjm</code>. This object can be further customised using the
<span class="pkg">ggplot2</span> package. It can also be passed to the function
<code>plot_stack_jm</code>.
</p>
<p><code>plot_stack_jm</code> returns an object of class
<code><a href="../../bayesplot/html/bayesplot_grid.html">bayesplot_grid</a></code> that includes plots of the
estimated subject-specific longitudinal trajectories stacked on top of the 
associated subject-specific survival curve.
</p>


<h3>See Also</h3>

<p><code><a href="posterior_survfit.html">posterior_survfit</a></code>, <code><a href="plot.survfit.stanjm.html">plot_stack_jm</a></code>,
<code><a href="posterior_traj.html">posterior_traj</a></code>, <code><a href="plot.predict.stanjm.html">plot.predict.stanjm</a></code>
</p>
<p><code><a href="plot.predict.stanjm.html">plot.predict.stanjm</a></code>, <code><a href="plot.survfit.stanjm.html">plot.survfit.stanjm</a></code>,
<code><a href="posterior_predict.stanreg.html">posterior_predict</a></code>, <code><a href="posterior_survfit.html">posterior_survfit</a></code>
</p>


<h3>Examples</h3>

<pre>

  # Run example model if not already loaded
  if (!exists("example_jm")) example(example_jm)
  
  # Obtain subject-specific conditional survival probabilities
  # for all individuals in the estimation dataset.
  ps1 &lt;- posterior_survfit(example_jm, extrapolate = TRUE)
  
  # We then plot the conditional survival probabilities for
  # a subset of individuals
  plot(ps1, ids = c(7,13,15))
  # We can change or add attributes to the plot
  plot(ps1, ids = c(7,13,15), limits = "none")
  plot(ps1, ids = c(7,13,15), xlab = "Follow up time")
  plot(ps1, ids = c(7,13,15), ci_geom_args = list(fill = "red"),
       color = "blue", linetype = 2)
  plot(ps1, ids = c(7,13,15), facet_scales = "fixed")
  
  # Since the returned plot is also a ggplot object, we can
  # modify some of its attributes after it has been returned
  plot1 &lt;- plot(ps1, ids = c(7,13,15))
  plot1 + 
    ggplot2::theme(strip.background = ggplot2::element_blank()) +
    ggplot2::coord_cartesian(xlim = c(0, 15)) +
    ggplot2::labs(title = "Some plotted survival functions")
    
  # We can also combine the plot(s) of the estimated 
  # subject-specific survival functions, with plot(s) 
  # of the estimated longitudinal trajectories for the
  # same individuals
  ps1 &lt;- posterior_survfit(example_jm, ids = c(7,13,15))
  pt1 &lt;- posterior_traj(example_jm, , ids = c(7,13,15))
  plot_surv &lt;- plot(ps1) 
  plot_traj &lt;- plot(pt1, vline = TRUE, plot_observed = TRUE)
  plot_stack_jm(plot_traj, plot_surv)
   
  # Lastly, let us plot the standardised survival function
  # based on all individuals in our estimation dataset
  ps2 &lt;- posterior_survfit(example_jm, standardise = TRUE, times = 0,
                          control = list(epoints = 20))
  plot(ps2)   

   

  if (!exists("example_jm")) example(example_jm)
  ps1 &lt;- posterior_survfit(example_jm, ids = c(7,13,15))
  pt1 &lt;- posterior_traj(example_jm, ids = c(7,13,15), extrapolate = TRUE)
  plot_surv &lt;- plot(ps1) 
  plot_traj &lt;- plot(pt1, vline = TRUE, plot_observed = TRUE)
  plot_stack_jm(plot_traj, plot_surv)

 
</pre>

<hr /><div style="text-align: center;">[Package <em>rstanarm</em> version 2.17.3 <a href="00Index.html">Index</a>]</div>
</body></html>
