---
output:
  html_document:
params:
  setup: '`r SMRD.resources:::setup( )`'
  show_solution: false
---

__The supplier of an electromechanical control for a household appliance ran an accelerated life test on sample controls.  In the test, 25 controls were put on test and run until 30 thousand cycles had been accumulated.  Failures occurred at 5, 21,and 28 thousand cycles.  The other 22 controls did not fail by the end of the test.__
  
a. __Compute and plot a nonparametric estimate for $F(t)$.__

`r SMRD.resources:::solution()$begin`
A nonparametric estimate for $F(t)$ can be easily produced using a 'life data' object from the SMRD pacakge.  Life data objects are created with the function `frame.to.ld` which requires the data to be formatted into a data frame.  

If the data set is pre-loaded as part of the SMRD package (as is the case for the data set in this exercise), it has already been formatted into a data frame.  In this case the life data object can be created by simply entering the name of the data set into `frame.to.ld`, for example 

```{r echo=TRUE}
prob3_5.ld <- frame.to.ld(frame = prob3_5,
                          response.column = 1,
                          censor.column = 2,
                          time.units = "Kilocycles")
```

NOTE: The complete list of pre-loaded data sets in the SMRD package, can be found by running `data(package = 'SMRD')` in the R console.

A plot of the nonparametric estimate for $F(t)$ is produced by plotting the life.data object, as shown in Figure 1.  This exercise does not require us to plot the confidence bands along with the estimate, so we set the `band.type` argument to "none". The `ylim` argument is added because of the way R dynamically sets axis values for a plot.  Try running following code without the `ylim` argument.  This problem could easily be fixed such that the `ylim` argument would not need to be set...but the fix would cause bigger issues for other exercises. 

```{r echo=2,fig.align='center', fig.cap="Plot of the nonparametric estimate of the cdf for Problem 3.5"}
par(family = "serif")
plot(prob3_5.ld, 
     band.type = "none", 
     ylim = c(0,0.1))
```

To compute the values of $\widehat{F(t_{i})}$ and present them in a table the following code is used.

```{r, echo=TRUE, results='asis'}
xtab <- print(cdfest(prob3_5.ld))$table

knitr::kable(xtab, 
             row.names = F, 
             format = 'pandoc',
             align = c('ccccccc'), 
             digits = rep(c(0,4), c(3,4)),
             caption = "Nonparametric CDF Estimate for Problem 3.5")
```
`r SMRD.resources:::solution()$end`

b. __Compute an approximate 95% confidence interval for the probability that an electromechanical device from the same production process, tested in the same way, would fail before 30 thousand cycles.  Use the conservative binomial approach.__

`r SMRD.resources:::solution()$begin`
In Example 3.1 we see that the nonparametric estimate for $\widehat{F}(\text{30 kilocycles})$ with singly censored data is

$$
\frac{\#\text{ failed up to 30 kilocycles}}{\#\text{ at risk}}=\frac{3}{25}.
$$

The Clopper-Pearson 'exact' confidence interval based on the cumulative probabilities of the binomial distribution (i.e., the exact distribution rather than an approximation) gives a lower 95\% confidence bound of

$$
\left(1+\frac{(25-3+1)\times \mathcal{F}(.975,50-6+2,6)}{3}\right)^{-1}=0.02546
$$

and an upper 95% confidence bound of

$$
\left(1+\frac{25-3}{(3+1)\times \mathcal{F}(.925,6+2,50-6)}\right)^{-1}=0.31219
$$

where $\mathcal{F}(p,df_{1},df_{2})$ denotes the $p^{th}$ quantile of an $F$ distribution with $df_{1}$ and $df_{2}$ degrees of freedom.
`r SMRD.resources:::solution()$end`
    
c. __Compute an approximate 95% confidence interval for the probability that an electromechanical device from the same production process, tested in the same way, would fail before 30 thousand cycles.  Use the normal-approximation method based on $Z_{\widehat{F}(30)}\sim NOR(0,1)$__

`r SMRD.resources:::solution()$begin`
Using the $Z_{\widehat{F}(30)}\sim NOR(0,1)$ appoximate method results in a lower $95\%$ confidence bound of

$$
\frac{3}{25}-1.96\times \sqrt{\frac{3}{25}\times\left(1-\frac{3}{25}\right)\times\frac{1}{25}}=-0.007
$$

and an upper $95%$ confidence bound of

$$
\frac{3}{25}+1.96\times \sqrt{\frac{3}{25}\times\left(1-\frac{3}{25}\right)\times\frac{1}{25}}=0.247
$$
`r SMRD.resources:::solution()$end`

d. __Explain why, in this situation, the approach in part (b) would be preferred to the approach in part (c)__

`r SMRD.resources:::solution()$begin`
The CI in part (b) is conservative as it based on the exact distribution of the value of $F(t)$ (i.e. the binomial) while the method used in part (c) is an approximation of the binomal distribution. Further, the approximation in part (c) has a negative lower bound which is not possible.
`r SMRD.resources:::solution()$end`

e. __The appliance manufacturer is really interested in the probability of the number of days to failure for its product.  Use-rate differs from household to household, but the average rate is 2.3 cycles per day.  What can the manufacturer say about the proportion of devices that would fail in 10 years of operation (the expected technological life of the product)?__

`r SMRD.resources:::solution()$begin`
We can convert usage in days to usage in cycles by making the following conversion

$$
10 \text{ years}\times\left(365\hspace{3pt} \frac{\text{days}}{\text{year}}\right) \times\left(2.3\hspace{3pt} \frac{\text{cycles}}{\text{day}}\right) \approx 8.4\times10^3 \text{ cycles}.
$$

Therefore, we want to compute a $95%$ CI for $F(8.4)$ where usage is measured in kilocycles. From the plot in part a) the manufacturer can say that with 95% confidence the proportion of electromechanical control failures after 10 years of use at a use rate of 2.3 cycles per day is in the interval (0,0.24)

Alternatively, if the manufacturer uses the binomial (Clopper-Pearson) approximation, the reported 95% confidence interval would be $(0.01,0.204).$

If the manufacturer uses the normal approximation, the reported 95% confidence interval would be $(0.01,0.204).$

Finally, if the manufacturer used R to compute the 95% confidence interval by plotting the Kaplan-Meier estimate from a "Surv" object, the reported interval would be $(0,0.114).$

If the electromechanical controls experienced only one of two usage rates $r_{1} \text{ or } r_{2}, \text{ where } r_{1}>r_{2}$ such that the lifetime of any control device follows either $F_{1}(t|\theta_{1})$ or $F_{2}(t|\theta_{2})$.  The lifetime of the overall population would then depend on the proportion of units experiencing each usage rate denoted $\zeta_{i}, i=1,2,\hspace{3pt} \text{where}\hspace{3pt} \zeta_{2}=1-\zeta_{1}$. The probability of failure for the population would then be expressed as

$$
F_{_T}(t)=\sum_{i=1}^{2}\zeta_{i}F_{i}(t|\theta_{i})
$$
`r SMRD.resources:::solution()$end`

f. __Refer to part (e).  Describe an appropriate model to use when use-rate varies in the population of units.  To simplify, start by assuming that there are only two differnt use-rates.  Discuss, using appropriate expressions__
